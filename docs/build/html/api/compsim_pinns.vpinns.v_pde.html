<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>compsim_pinns.vpinns.v_pde module &#8212; CompSim-PINN 2025.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=14229d9d"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="compsim_pinns.vpinns.quad_rule module" href="compsim_pinns.vpinns.quad_rule.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-compsim_pinns.vpinns.v_pde">
<span id="compsim-pinns-vpinns-v-pde-module"></span><h1>compsim_pinns.vpinns.v_pde module<a class="headerlink" href="#module-compsim_pinns.vpinns.v_pde" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">compsim_pinns.vpinns.v_pde.</span></span><span class="sig-name descname"><span class="pre">VariationalPDE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/compsim_pinns/vpinns/v_pde.html#VariationalPDE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></p>
<p>Variational PDE solver based on weak formulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> – Instance of <code class="docutils literal notranslate"><span class="pre">Geometry</span></code>.</p></li>
<li><p><strong>pde</strong> – A global PDE or a list of PDEs. <code class="docutils literal notranslate"><span class="pre">None</span></code> if no global PDE.</p></li>
<li><p><strong>bcs</strong> – A boundary condition or a list of boundary conditions. Use <code class="docutils literal notranslate"><span class="pre">[]</span></code> if no
boundary condition.</p></li>
<li><p><strong>num_domain</strong> (<em>int</em>) – The number of training points sampled inside the domain.</p></li>
<li><p><strong>num_boundary</strong> (<em>int</em>) – The number of training points sampled on the boundary.</p></li>
<li><p><strong>train_distribution</strong> (<em>string</em>) – The distribution to sample training points. One of
the following: “uniform” (equispaced grid), “pseudo” (pseudorandom), “LHS”
(Latin hypercube sampling), “Halton” (Halton sequence), “Hammersley”
(Hammersley sequence), or “Sobol” (Sobol sequence).</p></li>
<li><p><strong>anchors</strong> – A Numpy array of training points, in addition to the <cite>num_domain</cite> and
<cite>num_boundary</cite> sampled points.</p></li>
<li><p><strong>exclusions</strong> – A Numpy array of points to be excluded for training.</p></li>
<li><p><strong>solution</strong> – The reference solution.</p></li>
<li><p><strong>num_test</strong> – The number of points sampled inside the domain for testing PDE loss.
The testing points for BCs/ICs are the same set of points used for training.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the training points will be used for testing.</p></li>
<li><p><strong>auxiliary_var_function</strong> – A function that inputs <cite>train_x</cite> or <cite>test_x</cite> and outputs
auxiliary variables.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The testing points include points inside the domain and points on the boundary,
and they may not have the same density, and thus the entire testing points may
not be uniformly distributed. As a result, if you have a reference solution
(<cite>solution</cite>) and would like to compute a metric such as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;l2 relative error&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>then the metric may not be very accurate. To better compute a metric, you can
sample the points manually, and then use <code class="docutils literal notranslate"><span class="pre">Model.predict()</span></code> to predict the
solution on thess points and compute the metric:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">uniform_points</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">error</span><span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">l2_relative_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.train_x_all">
<span class="sig-name descname"><span class="pre">train_x_all</span></span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.train_x_all" title="Link to this definition">¶</a></dt>
<dd><p>A Numpy array of points for PDE training. <cite>train_x_all</cite> is
unordered, and does not have duplication. If there is PDE, then
<cite>train_x_all</cite> is used as the training points of PDE.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.train_x_bc">
<span class="sig-name descname"><span class="pre">train_x_bc</span></span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.train_x_bc" title="Link to this definition">¶</a></dt>
<dd><p>A Numpy array of the training points for BCs. <cite>train_x_bc</cite> is
constructed from <cite>train_x_all</cite> at the first step of training, by default it
won’t be updated when <cite>train_x_all</cite> changes. To update <cite>train_x_bc</cite>, set it
to <cite>None</cite> and call <cite>bc_points</cite>, and then update the loss function by
<code class="docutils literal notranslate"><span class="pre">model.compile()</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.num_bcs">
<span class="sig-name descname"><span class="pre">num_bcs</span></span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.num_bcs" title="Link to this definition">¶</a></dt>
<dd><p><cite>num_bcs[i]</cite> is the number of points for <cite>bcs[i]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.train_x">
<span class="sig-name descname"><span class="pre">train_x</span></span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.train_x" title="Link to this definition">¶</a></dt>
<dd><p>A Numpy array of the points fed into the network for training.
<cite>train_x</cite> is ordered from BC points (<cite>train_x_bc</cite>) to PDE points
(<cite>train_x_all</cite>), and may have duplicate points.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.train_aux_vars">
<span class="sig-name descname"><span class="pre">train_aux_vars</span></span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.train_aux_vars" title="Link to this definition">¶</a></dt>
<dd><p>Auxiliary variables that associate with <cite>train_x</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.test_x">
<span class="sig-name descname"><span class="pre">test_x</span></span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.test_x" title="Link to this definition">¶</a></dt>
<dd><p>A Numpy array of the points fed into the network for testing, ordered
from BCs to PDE. The BC points are exactly the same points in <cite>train_x_bc</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.test_aux_vars">
<span class="sig-name descname"><span class="pre">test_aux_vars</span></span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.test_aux_vars" title="Link to this definition">¶</a></dt>
<dd><p>Auxiliary variables that associate with <cite>test_x</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.add_anchors">
<span class="sig-name descname"><span class="pre">add_anchors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/compsim_pinns/vpinns/v_pde.html#VariationalPDE.add_anchors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.add_anchors" title="Link to this definition">¶</a></dt>
<dd><p>Add new points for training PDE losses. The BC points will not be updated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.bc_points">
<span class="sig-name descname"><span class="pre">bc_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.bc_points" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/compsim_pinns/vpinns/v_pde.html#VariationalPDE.losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.losses" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.replace_with_anchors">
<span class="sig-name descname"><span class="pre">replace_with_anchors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/compsim_pinns/vpinns/v_pde.html#VariationalPDE.replace_with_anchors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.replace_with_anchors" title="Link to this definition">¶</a></dt>
<dd><p>Replace the current PDE training points with anchors. The BC points will not be changed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.test_points">
<span class="sig-name descname"><span class="pre">test_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/compsim_pinns/vpinns/v_pde.html#VariationalPDE.test_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.test_points" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="compsim_pinns.vpinns.v_pde.VariationalPDE.train_next_batch">
<span class="sig-name descname"><span class="pre">train_next_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#compsim_pinns.vpinns.v_pde.VariationalPDE.train_next_batch" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CompSim-PINN</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=imcs-compsim&repo=pinns_for_comp_mech&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">compsim_pinns</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="compsim_pinns.html">compsim_pinns package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">compsim_pinns</a><ul>
  <li><a href="compsim_pinns.html">compsim_pinns package</a><ul>
  <li><a href="compsim_pinns.vpinns.html">compsim_pinns.vpinns package</a><ul>
      <li>Previous: <a href="compsim_pinns.vpinns.quad_rule.html" title="previous chapter">compsim_pinns.vpinns.quad_rule module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Institute for Mathematics and Computer-Based Simulation (IMCS).
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/api/compsim_pinns.vpinns.v_pde.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/imcs-compsim/pinns_for_comp_mech" class="github">
        <img src="../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>