<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>utils.elasticity.elasticity_utils &#8212; CompSim-PINN 2025.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=14229d9d"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for utils.elasticity.elasticity_utils</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">deepxde</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dde</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils.geometry.geometry_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">calculate_boundary_normals</span><span class="p">,</span> <span class="n">calculate_boundary_normals_3D</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">deepxde.backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bkd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">deepxde</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>

<span class="c1"># global variables</span>
<span class="n">lame</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">shear</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">body_force_function</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">geom</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">spacetime_domain</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="momentum_2d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.momentum_2d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">momentum_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>    
    <span class="c1"># calculate strain terms (kinematics, small strain theory)</span>

    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># governing equation</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_yy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_xy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_xy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span>
    <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">]</span></div>


<div class="viewcode-block" id="momentum_2d_plane_stress">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.momentum_2d_plane_stress">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">momentum_2d_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>    
    <span class="c1"># calculate strain terms (kinematics, small strain theory)</span>

    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># governing equation</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_yy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_xy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">sigma_xy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span>
    <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">]</span></div>


<div class="viewcode-block" id="elastic_strain_2d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.elastic_strain_2d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">elastic_strain_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the strain tensor components for plane stress condition in 2D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx, sigma_yy, sigma_xy: Placeholder (tf)</span>
<span class="sd">        contains the components of stress tensor </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">eps_xx</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">eps_yy</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eps_xy</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">eps_xx</span><span class="p">,</span> <span class="n">eps_yy</span><span class="p">,</span> <span class="n">eps_xy</span></div>



<div class="viewcode-block" id="problem_parameters">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.problem_parameters">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">problem_parameters</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the elastic properties for given Lame and shear modulus.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        nu : Float</span>
<span class="sd">            Poisson&#39;s ratio</span>
<span class="sd">        lame: Float</span>
<span class="sd">            Lame parameter</span>
<span class="sd">        shear: Float</span>
<span class="sd">            Shear modulus</span>
<span class="sd">        e_modul: Float</span>
<span class="sd">            Young&#39;s modulus</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">e_modul</span> <span class="o">=</span> <span class="n">shear</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">lame</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">shear</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">lame</span><span class="o">+</span><span class="n">shear</span><span class="p">)</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">lame</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">lame</span><span class="o">+</span><span class="n">shear</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">nu</span><span class="p">,</span> <span class="n">lame</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">e_modul</span></div>



<div class="viewcode-block" id="stress_plane_strain">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.stress_plane_strain">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">stress_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the stress tensor components for plane stress condition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx, sigma_yy, sigma_xy: Placeholder (tf)</span>
<span class="sd">        contains the components of stress tensor </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">eps_xx</span><span class="p">,</span> <span class="n">eps_yy</span><span class="p">,</span> <span class="n">eps_xy</span> <span class="o">=</span> <span class="n">elastic_strain_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">nu</span><span class="p">,</span><span class="n">lame</span><span class="p">,</span><span class="n">shear</span><span class="p">,</span><span class="n">e_modul</span> <span class="o">=</span> <span class="n">problem_parameters</span><span class="p">()</span>
    
    <span class="c1"># calculate stress terms (constitutive law - plane strain)</span>
    <span class="n">sigma_xx</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_xx</span><span class="o">+</span><span class="n">nu</span><span class="o">*</span><span class="n">eps_yy</span><span class="p">)</span>
    <span class="n">sigma_yy</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">nu</span><span class="o">*</span><span class="n">eps_xx</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_yy</span><span class="p">)</span>
    <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_xy</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span></div>



<div class="viewcode-block" id="stress_plane_stress">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.stress_plane_stress">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">stress_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the stress tensor components for plane stress condition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx, sigma_yy, sigma_xy: Placeholder (tf)</span>
<span class="sd">        contains the components of stress tensor </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">eps_xx</span><span class="p">,</span> <span class="n">eps_yy</span><span class="p">,</span> <span class="n">eps_xy</span> <span class="o">=</span> <span class="n">elastic_strain_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">nu</span><span class="p">,</span><span class="n">lame</span><span class="p">,</span><span class="n">shear</span><span class="p">,</span><span class="n">e_modul</span> <span class="o">=</span> <span class="n">problem_parameters</span><span class="p">()</span>

    <span class="n">sigma_xx</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">eps_xx</span><span class="o">+</span><span class="n">nu</span><span class="o">*</span><span class="n">eps_yy</span><span class="p">)</span>
    <span class="n">sigma_yy</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nu</span><span class="o">*</span><span class="n">eps_xx</span><span class="o">+</span><span class="n">eps_yy</span><span class="p">)</span>
    <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_xy</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span></div>


<div class="viewcode-block" id="zero_neumman_plane_stress_x">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.zero_neumman_plane_stress_x">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">zero_neumman_plane_stress_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates x component of the homogeneous Neumann BC</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments (coordinates x and y)</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output (predicted displacement in x and y direction)</span>
<span class="sd">    X: np.array</span>
<span class="sd">        the input arguments as an array (coordinates x and y)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx_n_x + sigma_xy_n_y: tensor</span>
<span class="sd">        x component of the homogeneous Neumann BC</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>
    <span class="n">Tx</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span></div>


<div class="viewcode-block" id="zero_neumman_plane_stress_y">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.zero_neumman_plane_stress_y">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">zero_neumman_plane_stress_y</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates y component of the homogeneous Neumann BC</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments (coordinates x and y)</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output (predicted displacement in x and y direction)</span>
<span class="sd">    X: np.array</span>
<span class="sd">        the input arguments as an array (coordinates x and y)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma_yx_n_x + sigma_yy_n_y: tensor</span>
<span class="sd">        y component of the homogeneous Neumann BC</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Ty</span></div>


<div class="viewcode-block" id="zero_neumman_plane_strain_x">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.zero_neumman_plane_strain_x">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">zero_neumman_plane_strain_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates x component of the homogeneous Neumann BC</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments (coordinates x and y)</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output (predicted displacement in x and y direction)</span>
<span class="sd">    X: np.array</span>
<span class="sd">        the input arguments as an array (coordinates x and y)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx_n_x + sigma_xy_n_y: tensor</span>
<span class="sd">        x component of the homogeneous Neumann BC</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>
    <span class="n">Tx</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span></div>


<div class="viewcode-block" id="zero_neumman_plane_strain_y">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.zero_neumman_plane_strain_y">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">zero_neumman_plane_strain_y</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates y component of the homogeneous Neumann BC</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments (coordinates x and y)</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output (predicted displacement in x and y direction)</span>
<span class="sd">    X: np.array</span>
<span class="sd">        the input arguments as an array (coordinates x and y)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma_yx_n_x + sigma_yy_n_y: tensor</span>
<span class="sd">        y component of the homogeneous Neumann BC</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Ty</span></div>


<div class="viewcode-block" id="lin_iso_elasticity_plane_stress">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.lin_iso_elasticity_plane_stress">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_iso_elasticity_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the difference between predicted stresses and calculated stresses based on linear isotropic material law and predicted displacements in plane stress condition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    term_x, term_y, term_xy: tensor</span>
<span class="sd">        difference between predicted stresses and calculated stresses in X, Y and XY direction </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="n">term_x</span> <span class="o">=</span> <span class="n">sigma_xx</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">term_y</span> <span class="o">=</span> <span class="n">sigma_yy</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">term_xy</span> <span class="o">=</span> <span class="n">sigma_xy</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span></div>


<div class="viewcode-block" id="pde_mixed_plane_stress">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_plane_stress">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and generates the terms for pde of the mixed-variable formulation in case of plane stress</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    momentum_x, momentum_y, term_x, term_y, term_xy: tensor</span>
<span class="sd">        momentum_x, momentum_y: momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_x, term_y, term_xy: difference between predicted stresses and calculated stresses in X, Y and XY direction</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span>
    <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span>
    
    <span class="c1"># material law</span>
    <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span> <span class="o">=</span> <span class="n">lin_iso_elasticity_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">]</span></div>


<div class="viewcode-block" id="lin_iso_elasticity_plane_strain">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.lin_iso_elasticity_plane_strain">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_iso_elasticity_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the difference between predicted stresses and calculated stresses based on linear isotropic material law and predicted displacements in plane strain condition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    term_x, term_y, term_xy: tensor</span>
<span class="sd">        difference between predicted stresses and calculated stresses in X, Y and XY direction </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">stress_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="n">term_x</span> <span class="o">=</span> <span class="n">sigma_xx</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">term_y</span> <span class="o">=</span> <span class="n">sigma_yy</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">term_xy</span> <span class="o">=</span> <span class="n">sigma_xy</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span></div>


<div class="viewcode-block" id="pde_mixed_plane_strain">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_plane_strain">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and generates the terms for pde of the mixed-variable formulation in case of plane strain</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : tensor</span>
<span class="sd">        the input arguments</span>
<span class="sd">    y: tensor</span>
<span class="sd">        the network output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    momentum_x, momentum_y, term_x, term_y, term_xy: tensor</span>
<span class="sd">        momentum_x, momentum_y: momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_x, term_y, term_xy: difference between predicted stresses and calculated stresses in X, Y and XY direction</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># governing equation</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span>
    <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span>
    
    <span class="c1"># material law</span>
    <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span> <span class="o">=</span> <span class="n">lin_iso_elasticity_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">]</span></div>


<div class="viewcode-block" id="stress_to_traction_2d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.stress_to_traction_2d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the traction components in cartesian (x,y) and polar coordinates (n (normal) and t (tangential)).</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        sigma_xx (any): Stress component in x direction</span>
<span class="sd">        sigma_yy (any): Stress component in y direction</span>
<span class="sd">        sigma_xy (any): Stress component in xy direction (shear)</span>
<span class="sd">        normals (vector): Normal vectors</span>
<span class="sd">        cond (boolean): Dimensions of stresses and and normals have to match. Normals are calculated on the boundary, while stresses are calculated everywhere.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx, Ty, Tn, Tt: any</span>
<span class="sd">            Traction components in cartesian (x,y) and polar coordinates (n (normal) and t (tangential))</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">nx</span> <span class="o">=</span> <span class="n">normals</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">normals</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">sigma_xx_n_x</span> <span class="o">=</span> <span class="n">sigma_xx</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nx</span>
    <span class="n">sigma_xy_n_y</span> <span class="o">=</span> <span class="n">sigma_xy</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">ny</span>

    <span class="n">sigma_yx_n_x</span> <span class="o">=</span> <span class="n">sigma_xy</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nx</span>
    <span class="n">sigma_yy_n_y</span> <span class="o">=</span> <span class="n">sigma_yy</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">ny</span>
    
    <span class="n">Tx</span> <span class="o">=</span> <span class="n">sigma_xx_n_x</span> <span class="o">+</span> <span class="n">sigma_xy_n_y</span>
    <span class="n">Ty</span> <span class="o">=</span> <span class="n">sigma_yx_n_x</span> <span class="o">+</span> <span class="n">sigma_yy_n_y</span>
    <span class="n">Tn</span> <span class="o">=</span> <span class="n">Tx</span><span class="o">*</span><span class="n">nx</span> <span class="o">+</span> <span class="n">Ty</span><span class="o">*</span><span class="n">ny</span>
    <span class="n">Tt</span> <span class="o">=</span> <span class="o">-</span><span class="n">Tx</span><span class="o">*</span><span class="n">ny</span> <span class="o">+</span> <span class="n">Ty</span><span class="o">*</span><span class="n">nx</span> <span class="c1"># Direction is clockwise --&gt; if you go from normal tangetial</span>

    <span class="k">return</span> <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt</span></div>


<div class="viewcode-block" id="calculate_traction_mixed_formulation">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.calculate_traction_mixed_formulation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_traction_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates traction components in the mixed formulation. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        x : tensor</span>
<span class="sd">            Network input</span>
<span class="sd">        y: tensor</span>
<span class="sd">            Network output</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx, Ty, Tn, Tt: any</span>
<span class="sd">            Traction components in cartesian (x,y) and polar coordinates (n (normal) and t (tangential))</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> 
    
    <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>

    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt</span> <span class="o">=</span> <span class="n">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt</span></div>


<div class="viewcode-block" id="zero_neumann_x_mixed_formulation">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.zero_neumann_x_mixed_formulation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">zero_neumann_x_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates/Enforces x component of traction vector in the mixed formulation. This is also known as zero Neumann boundary conditions in x direction.  </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        x : tensor</span>
<span class="sd">            Network input</span>
<span class="sd">        y: tensor</span>
<span class="sd">            Network output</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx: any</span>
<span class="sd">            x component of traction vector</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    
    <span class="n">Tx</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">calculate_traction_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span></div>


<div class="viewcode-block" id="zero_neumann_y_mixed_formulation">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.zero_neumann_y_mixed_formulation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">zero_neumann_y_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates/Enforces y component of traction vector in the mixed formulation. This is also known as zero Neumann boundary conditions in y direction.  </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        x : tensor</span>
<span class="sd">            Network input</span>
<span class="sd">        y: tensor</span>
<span class="sd">            Network output</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Ty: any</span>
<span class="sd">            y component of traction vector</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    
    <span class="n">_</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">calculate_traction_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Ty</span></div>

<span class="c1">#################################################################################################################################################################################</span>
<span class="c1"># Equations for 3D elasticity</span>
<span class="c1">#################################################################################################################################################################################</span>
<div class="viewcode-block" id="get_elastic_strain_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_elastic_strain_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_elastic_strain_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the strain tensor components in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    eps_xx, eps_yy, eps_zz, eps_xy, eps_yz, eps_xz: tensor</span>
<span class="sd">        contains the components of strain tensor in 3D</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Normal strains</span>
    <span class="n">eps_xx</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">eps_yy</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eps_zz</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Shear strains</span>
    <span class="n">eps_xy</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">eps_yz</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">eps_xz</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">eps_xx</span><span class="p">,</span> <span class="n">eps_yy</span><span class="p">,</span> <span class="n">eps_zz</span><span class="p">,</span> <span class="n">eps_xy</span><span class="p">,</span> <span class="n">eps_yz</span><span class="p">,</span> <span class="n">eps_xz</span> </div>


<div class="viewcode-block" id="get_stress_tensor">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_stress_tensor">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_stress_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the stress tensor components in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz: tensor</span>
<span class="sd">        contains the components of stress tensor in 3D</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">eps_xx</span><span class="p">,</span> <span class="n">eps_yy</span><span class="p">,</span> <span class="n">eps_zz</span><span class="p">,</span> <span class="n">eps_xy</span><span class="p">,</span> <span class="n">eps_yz</span><span class="p">,</span> <span class="n">eps_xz</span> <span class="o">=</span> <span class="n">get_elastic_strain_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">nu</span><span class="p">,</span><span class="n">lame</span><span class="p">,</span><span class="n">shear</span><span class="p">,</span><span class="n">e_modul</span> <span class="o">=</span> <span class="n">problem_parameters</span><span class="p">()</span>
    
    <span class="c1"># calculate stress terms (constitutive law)</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">e_modul</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span>
    
    <span class="n">sigma_xx</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_xx</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_yy</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_zz</span><span class="p">)</span>
    <span class="n">sigma_yy</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_yy</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_xx</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_zz</span><span class="p">)</span>
    <span class="n">sigma_zz</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_zz</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_xx</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_yy</span><span class="p">)</span>
    
    <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps_xy</span>
    <span class="n">sigma_yz</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps_yz</span>
    <span class="n">sigma_xz</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps_xz</span>

    <span class="k">return</span> <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_zz</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">sigma_yz</span><span class="p">,</span> <span class="n">sigma_xz</span></div>


<div class="viewcode-block" id="get_stress_coupling">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_stress_coupling">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_stress_coupling</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the difference between predicted stresses and calculated stresses based on linear isotropic material law and predicted displacements in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output: disp_x, disp_y, disp_z, sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: tensor</span>
<span class="sd">        difference between predicted stresses and calculated stresses in 3D</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_zz</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">sigma_yz</span><span class="p">,</span> <span class="n">sigma_xz</span> <span class="o">=</span> <span class="n">get_stress_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="n">term_xx</span> <span class="o">=</span> <span class="n">sigma_xx</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">term_yy</span> <span class="o">=</span> <span class="n">sigma_yy</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">term_zz</span> <span class="o">=</span> <span class="n">sigma_zz</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">term_xy</span> <span class="o">=</span> <span class="n">sigma_xy</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">term_yz</span> <span class="o">=</span> <span class="n">sigma_yz</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">term_xz</span> <span class="o">=</span> <span class="n">sigma_xz</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">term_xx</span><span class="p">,</span> <span class="n">term_yy</span><span class="p">,</span> <span class="n">term_zz</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">,</span> <span class="n">term_yz</span><span class="p">,</span> <span class="n">term_xz</span></div>


<div class="viewcode-block" id="pde_mixed_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and generates the terms for PDE of the mixed-variable formulation in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output: disp_x, disp_y, disp_z, sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    momentum_x, momentum_y, momentum_z, term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: tensor</span>
<span class="sd">        momentum_x, momentum_y, momentum_z: momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: difference between predicted stresses and calculated stresses in X, Y, Z, XY, YZ, and XZ directions</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Stress derivatives</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#sigma_xx_y = dde.grad.jacobian(y, x, i=3, j=1)</span>
    <span class="c1">#sigma_xx_z = dde.grad.jacobian(y, x, i=3, j=2)</span>
    
    <span class="c1">#sigma_yy_x = dde.grad.jacobian(y, x, i=4, j=0)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#sigma_yy_z = dde.grad.jacobian(y, x, i=4, j=2)</span>
    
    <span class="c1">#sigma_zz_x = dde.grad.jacobian(y, x, i=5, j=0)</span>
    <span class="c1">#sigma_zz_y = dde.grad.jacobian(y, x, i=5, j=1)</span>
    <span class="n">sigma_zz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#sigma_xy_z = dde.grad.jacobian(y, x, i=6, j=2)</span>
    
    <span class="c1">#sigma_yz_x = dde.grad.jacobian(y, x, i=7, j=0)</span>
    <span class="n">sigma_yz_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_yz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">sigma_xz_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#sigma_xz_y = dde.grad.jacobian(y, x, i=8, j=1)</span>
    <span class="n">sigma_xz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Momentum equations</span>
    <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">sigma_xz_z</span>
    <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">sigma_yz_z</span>
    <span class="n">momentum_z</span> <span class="o">=</span> <span class="n">sigma_zz_z</span> <span class="o">+</span> <span class="n">sigma_xz_x</span> <span class="o">+</span> <span class="n">sigma_yz_y</span>

    <span class="c1"># Material law</span>
    <span class="n">term_xx</span><span class="p">,</span> <span class="n">term_yy</span><span class="p">,</span> <span class="n">term_zz</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">,</span> <span class="n">term_yz</span><span class="p">,</span> <span class="n">term_xz</span> <span class="o">=</span> <span class="n">get_stress_coupling</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">momentum_z</span><span class="p">,</span> <span class="n">term_xx</span><span class="p">,</span> <span class="n">term_yy</span><span class="p">,</span> <span class="n">term_zz</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">,</span> <span class="n">term_yz</span><span class="p">,</span> <span class="n">term_xz</span><span class="p">]</span></div>


<div class="viewcode-block" id="stress_to_traction_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.stress_to_traction_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">stress_to_traction_3d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_zz</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">sigma_xz</span><span class="p">,</span> <span class="n">sigma_yz</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">tangentials_1</span><span class="p">,</span> <span class="n">tangentials_2</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the traction components in Cartesian (x, y, z) and polar coordinates (n and t) in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sigma_xx : any</span>
<span class="sd">        Stress component in the x direction</span>
<span class="sd">    sigma_yy : any</span>
<span class="sd">        Stress component in the y direction</span>
<span class="sd">    sigma_zz : any</span>
<span class="sd">        Stress component in the z direction</span>
<span class="sd">    sigma_xy : any</span>
<span class="sd">        Shear stress component in the xy plane</span>
<span class="sd">    sigma_xz : any</span>
<span class="sd">        Shear stress component in the xz plane</span>
<span class="sd">    sigma_yz : any</span>
<span class="sd">        Shear stress component in the yz plane</span>
<span class="sd">    normals : numpy.ndarray</span>
<span class="sd">        Normal vectors</span>
<span class="sd">    tangentials_1 : numpy.ndarray</span>
<span class="sd">        Tangential vectors in the first coordinate direction</span>
<span class="sd">    tangentials_2 : numpy.ndarray</span>
<span class="sd">        Tangential vectors in the second coordinate direction</span>
<span class="sd">    cond : boolean</span>
<span class="sd">        Dimensions of stresses and normals have to match. Normals are calculated on the boundary, while stresses are calculated everywhere.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tx, Ty, Tz, Tn, Tt_1, Tt_2: any</span>
<span class="sd">        Traction components in Cartesian (x, y, z) coordinates and in normal (n) and tangential directions (t_1, t_2)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># normals </span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">normals</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">normals</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">nz</span> <span class="o">=</span> <span class="n">normals</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    
    <span class="c1"># tangentials in epsilon direction</span>
    <span class="n">t1x</span> <span class="o">=</span> <span class="n">tangentials_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t1y</span> <span class="o">=</span> <span class="n">tangentials_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">t1z</span> <span class="o">=</span> <span class="n">tangentials_1</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    
    <span class="c1"># tangentials in eta direction</span>
    <span class="n">t2x</span> <span class="o">=</span> <span class="n">tangentials_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t2y</span> <span class="o">=</span> <span class="n">tangentials_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">t2z</span> <span class="o">=</span> <span class="n">tangentials_2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

    <span class="c1"># Calculate the traction components in Cartesian coordinates</span>
    <span class="n">Tx</span> <span class="o">=</span> <span class="n">sigma_xx</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nx</span> <span class="o">+</span> <span class="n">sigma_xy</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">ny</span> <span class="o">+</span> <span class="n">sigma_xz</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nz</span>
    <span class="n">Ty</span> <span class="o">=</span> <span class="n">sigma_xy</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nx</span> <span class="o">+</span> <span class="n">sigma_yy</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">ny</span> <span class="o">+</span> <span class="n">sigma_yz</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nz</span>
    <span class="n">Tz</span> <span class="o">=</span> <span class="n">sigma_xz</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nx</span> <span class="o">+</span> <span class="n">sigma_yz</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">ny</span> <span class="o">+</span> <span class="n">sigma_zz</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">*</span><span class="n">nz</span>
    
    <span class="c1"># Calculate the traction components in polar coordinates (normal and tangential)</span>
    <span class="c1"># Calculate normal traction</span>
    <span class="n">Tn</span> <span class="o">=</span> <span class="n">Tx</span><span class="o">*</span><span class="n">nx</span> <span class="o">+</span> <span class="n">Ty</span><span class="o">*</span><span class="n">ny</span> <span class="o">+</span> <span class="n">Tz</span><span class="o">*</span><span class="n">nz</span>
    <span class="c1"># Calculate tangential tractions (popp thesis page 23). </span>
    <span class="n">Tt_1</span> <span class="o">=</span> <span class="n">Tx</span><span class="o">*</span><span class="n">t1x</span> <span class="o">+</span> <span class="n">Ty</span><span class="o">*</span><span class="n">t1y</span> <span class="o">+</span> <span class="n">Tz</span><span class="o">*</span><span class="n">t1z</span>
    <span class="n">Tt_2</span> <span class="o">=</span> <span class="n">Tx</span><span class="o">*</span><span class="n">t2x</span> <span class="o">+</span> <span class="n">Ty</span><span class="o">*</span><span class="n">t2y</span> <span class="o">+</span> <span class="n">Tz</span><span class="o">*</span><span class="n">t2z</span>
    
    <span class="k">return</span> <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span></div>


<div class="viewcode-block" id="get_tractions_mixed_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_tractions_mixed_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_tractions_mixed_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates traction components in the mixed formulation. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        x : tensor</span>
<span class="sd">            Network input</span>
<span class="sd">        y: tensor</span>
<span class="sd">            Network output</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx, Ty, Tz, Tn, Tt_1, Tt_2: tensor</span>
<span class="sd">            Traction components in cartesian (x,y) and polar coordinates (n (normal) and t (tangential))</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">sigma_xx</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">sigma_yy</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">sigma_zz</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">sigma_xy</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">sigma_yz</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">sigma_xz</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
    
    <span class="n">normals</span><span class="p">,</span> <span class="n">tangentials_1</span><span class="p">,</span> <span class="n">tangentials_2</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals_3D</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>

    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span> <span class="o">=</span> <span class="n">stress_to_traction_3d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_zz</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">sigma_xz</span><span class="p">,</span> <span class="n">sigma_yz</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">tangentials_1</span><span class="p">,</span> <span class="n">tangentials_2</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span></div>


<div class="viewcode-block" id="apply_zero_neumann_x_mixed_formulation">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.apply_zero_neumann_x_mixed_formulation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_zero_neumann_x_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates/Enforces x component of traction vector in the mixed formulation. This is also known as zero Neumann boundary conditions in x direction.  </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        x : tensor</span>
<span class="sd">            Network input</span>
<span class="sd">        y: tensor</span>
<span class="sd">            Network output</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx: tensor</span>
<span class="sd">            x component of traction vector</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span> <span class="o">=</span> <span class="n">get_tractions_mixed_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span></div>


<div class="viewcode-block" id="apply_zero_neumann_y_mixed_formulation">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.apply_zero_neumann_y_mixed_formulation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_zero_neumann_y_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates/Enforces y component of traction vector in the mixed formulation. This is also known as zero Neumann boundary conditions in y direction.  </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        x : tensor</span>
<span class="sd">            Network input</span>
<span class="sd">        y: tensor</span>
<span class="sd">            Network output</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Ty: tensor</span>
<span class="sd">            y component of traction vector</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span> <span class="o">=</span> <span class="n">get_tractions_mixed_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Ty</span></div>


<div class="viewcode-block" id="apply_zero_neumann_z_mixed_formulation">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.apply_zero_neumann_z_mixed_formulation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_zero_neumann_z_mixed_formulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates/Enforces z component of traction vector in the mixed formulation. This is also known as zero Neumann boundary conditions in z direction.  </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        x : tensor</span>
<span class="sd">            Network input</span>
<span class="sd">        y: tensor</span>
<span class="sd">            Network output</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tz: tensor</span>
<span class="sd">            z component of traction vector</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span> <span class="o">=</span> <span class="n">get_tractions_mixed_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tz</span></div>

<span class="c1">#################################################################################################################################################################################</span>
<span class="c1"># Equations for 2D elastodynamics</span>
<span class="c1">#################################################################################################################################################################################</span>
<div class="viewcode-block" id="pde_mixed_plane_stress_time_dependent">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_plane_stress_time_dependent">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_plane_stress_time_dependent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and displacements. </span>
<span class="sd">    It generates the terms for pde of the displacement-stress mixed-variable formulation in case of plane stress.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        x : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for coordinates of input points and time: x, y, t</span>
<span class="sd">        y : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for network output: disp_x, disp_y, sigma_xx, sigma_yy, sigma_xy</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        momentum_x, momentum_y, term_x, term_y, term_xy: tensor</span>
<span class="sd">            momentum_x, momentum_y: momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_x, term_y, term_xy: tensor</span>
<span class="sd">            Difference between predicted stresses and calculated stresses in X, Y and XY direction in case of plane stress</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># get ddu_x/dt2</span>
    <span class="n">u_x_tt</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># component is u_x, tt is the third input which is time tt=&gt;ij</span>
    <span class="c1"># get ddu_y/dt2</span>
    <span class="n">u_y_tt</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># component is u_y, tt is the third input which is time tt=&gt;ij</span>
    <span class="c1"># get stress derivatives</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">body_force_function</span><span class="p">:</span>
        <span class="n">body_force_x</span><span class="p">,</span> <span class="n">body_force_y</span> <span class="o">=</span> <span class="n">body_force_function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">body_force_x</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_x_tt</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">body_force_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_y_tt</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span>
    
    <span class="c1"># material law</span>
    <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span> <span class="o">=</span> <span class="n">lin_iso_elasticity_plane_stress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">]</span></div>


<div class="viewcode-block" id="pde_mixed_plane_strain_time_dependent">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_plane_strain_time_dependent">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_plane_strain_time_dependent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and displacements. </span>
<span class="sd">    It generates the terms for pde of the displacement-stress mixed-variable formulation in case of plane strain for elastodynamics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        x : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for coordinates of input points and time: x, y, t</span>
<span class="sd">        y : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for network output: c</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        momentum_x, momentum_y, term_x, term_y, term_xy : tensor</span>
<span class="sd">            momentum_x, momentum_y: momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_x, term_y, term_xy : tensor</span>
<span class="sd">            Difference between predicted stresses and calculated stresses in X, Y and XY direction in case of plane strain</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># get ddu_x/dt2</span>
    <span class="n">u_x_tt</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># component is u_x, tt is the third input which is time tt=&gt;ij</span>
    <span class="c1"># get ddu_y/dt2</span>
    <span class="n">u_y_tt</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># component is u_y, tt is the third input which is time tt=&gt;ij</span>
    <span class="c1"># get stress derivatives</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># momentum terms</span>
    <span class="k">if</span> <span class="n">body_force_function</span><span class="p">:</span>
        <span class="n">body_force_x</span><span class="p">,</span> <span class="n">body_force_y</span> <span class="o">=</span> <span class="n">body_force_function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">body_force_x</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_x_tt</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">body_force_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_y_tt</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_x_tt</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_y_tt</span>
    
    <span class="c1"># material law</span>
    <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span> <span class="o">=</span> <span class="n">lin_iso_elasticity_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">]</span></div>


<div class="viewcode-block" id="get_tractions_mixed_2d_time">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_tractions_mixed_2d_time">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_tractions_mixed_2d_time</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates traction components in 2D mixed formulation with time. Note that this method works only if the generated GMSH geometry is 3D. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        x : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for coordinates of input points and time: x, y, t</span>
<span class="sd">        y : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for network output: disp_x, disp_y, sigma_xx, sigma_yy, sigma_xy</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array (x,y,t)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx, Ty, Tn, Tt: tensor</span>
<span class="sd">            Traction components in cartesian (x,y) and polar coordinates (n (normal) and t (tangential))</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">sigma_xx</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">sigma_yy</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">sigma_xy</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    
    <span class="n">normals</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals_3D</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>

    <span class="c1"># get the traction vector, here we assume that time is the z-direction therefore nz = 0 on the target edges (surfaces).</span>
    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt</span> <span class="o">=</span> <span class="n">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt</span></div>


<div class="viewcode-block" id="get_tractions_mixed_2d_spacetime">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_tractions_mixed_2d_spacetime">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_tractions_mixed_2d_spacetime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates traction components in the mixed formulation. Note that this method works only if space-time domain (dde.geometry.GeometryXTime) is generated.</span>
<span class="sd">    </span>
<span class="sd">    ----------</span>
<span class="sd">        x : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for coordinates of input points and time: x, y, t</span>
<span class="sd">        y : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for network output: disp_x, disp_y, sigma_xx, sigma_yy, sigma_xy</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array (x,y,t)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx, Ty, Tn, Tt: any</span>
<span class="sd">            Traction components in cartesian (x,y) and polar coordinates (n (normal) and t (tangential))</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> 
    
    <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">spacetime_domain</span><span class="p">)</span>

    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt</span> <span class="o">=</span> <span class="n">stress_to_traction_2d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt</span></div>


<div class="viewcode-block" id="strain_rate_2d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.strain_rate_2d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">strain_rate_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the strain rate tensor components. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for coordinates of input points and time </span>
<span class="sd">    y : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for network output: disp_x, disp_y, sigma_xx, sigma_yy, sigma_xy, velocity_x, velocity_y</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx, sigma_yy, sigma_xy: Placeholder (tf)</span>
<span class="sd">        contains the components of stress tensor </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">eps_xx_rate</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">eps_yy_rate</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eps_xy_rate</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">eps_xx_rate</span><span class="p">,</span> <span class="n">eps_yy_rate</span><span class="p">,</span> <span class="n">eps_xy_rate</span></div>


<div class="viewcode-block" id="stress_rate_plane_strain">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.stress_rate_plane_strain">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">stress_rate_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the derivative of stress tensor components for plane strain condition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tf)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx, sigma_yy, sigma_xy: Placeholder (tf)</span>
<span class="sd">        contains the components of stress tensor </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># get the strain rates for plane strain</span>
    <span class="n">eps_xx_rate</span><span class="p">,</span> <span class="n">eps_yy_rate</span><span class="p">,</span> <span class="n">eps_xy_rate</span> <span class="o">=</span> <span class="n">strain_rate_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">nu</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">e_modul</span> <span class="o">=</span> <span class="n">problem_parameters</span><span class="p">()</span>
    
    <span class="c1"># calculate stress rates (hooke&#39;s law - plane strain)</span>
    <span class="n">sigma_xx_t</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_xx_rate</span><span class="o">+</span><span class="n">nu</span><span class="o">*</span><span class="n">eps_yy_rate</span><span class="p">)</span>
    <span class="n">sigma_yy_t</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">nu</span><span class="o">*</span><span class="n">eps_xx_rate</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_yy_rate</span><span class="p">)</span>
    <span class="n">sigma_xy_t</span> <span class="o">=</span> <span class="n">e_modul</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_xy_rate</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sigma_xx_t</span><span class="p">,</span> <span class="n">sigma_yy_t</span><span class="p">,</span> <span class="n">sigma_xy_t</span></div>


<div class="viewcode-block" id="get_plane_strain_stress_rate_coupling">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_plane_strain_stress_rate_coupling">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_plane_strain_stress_rate_coupling</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the difference between predicted stresses and calculated stresses based on linear isotropic material law and predicted displacements in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output: disp_x, disp_y, disp_z, sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: tensor</span>
<span class="sd">        difference between predicted stresses and calculated stresses in 3D</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># get stress rates from velocity fields</span>
    <span class="n">sigma_xx_t_v</span><span class="p">,</span> <span class="n">sigma_yy_t_v</span><span class="p">,</span> <span class="n">sigma_xy_t_v</span> <span class="o">=</span> <span class="n">stress_rate_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="c1"># get stress rates from stress fields</span>
    <span class="n">sigma_xx_t_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma_yy_t_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma_xy_t_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># couple the stress rates</span>
    <span class="n">term_x_rate</span> <span class="o">=</span> <span class="n">sigma_xx_t_v</span> <span class="o">-</span> <span class="n">sigma_xx_t_s</span>
    <span class="n">term_y_rate</span> <span class="o">=</span> <span class="n">sigma_yy_t_v</span> <span class="o">-</span> <span class="n">sigma_yy_t_s</span>
    <span class="n">term_xy_rate</span> <span class="o">=</span> <span class="n">sigma_xy_t_v</span> <span class="o">-</span> <span class="n">sigma_xy_t_s</span>
    
    <span class="k">return</span> <span class="n">term_x_rate</span><span class="p">,</span> <span class="n">term_y_rate</span><span class="p">,</span> <span class="n">term_xy_rate</span></div>


<div class="viewcode-block" id="get_velocity_coupling_2d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_velocity_coupling_2d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_velocity_coupling_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="c1"># coupling of displacement and velocities</span>
    <span class="n">u_x_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">u_y_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">v_x</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">v_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">term_x_velocity</span> <span class="o">=</span> <span class="n">u_x_t</span> <span class="o">-</span> <span class="n">v_x</span>
    <span class="n">term_y_velocity</span> <span class="o">=</span> <span class="n">u_y_t</span> <span class="o">-</span> <span class="n">v_y</span>
    
    <span class="k">return</span> <span class="n">term_x_velocity</span><span class="p">,</span> <span class="n">term_y_velocity</span></div>


<div class="viewcode-block" id="pde_mixed_velocity_plane_strain_time_dependent">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_velocity_plane_strain_time_dependent">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_velocity_plane_strain_time_dependent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and velocity fields. </span>
<span class="sd">    It generates the terms for pde of the displacement-velocity mixed-variable formulation in case of plane strain for elastodynamics.</span>
<span class="sd">    Additionally, it couples the velocity fields with displacements.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        x : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for coordinates of input points and time: x, y, t</span>
<span class="sd">        y : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for network output: disp_x, disp_y, sigma_xx, sigma_yy, sigma_xy, velocity_x, velocity_y</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        momentum_x, momentum_y : tensor</span>
<span class="sd">            momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_x, term_y, term_xy : tensor</span>
<span class="sd">            Difference between predicted stresses and calculated stresses in X, Y and XY direction in case of plane strain</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># get stress derivatives</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># get velocity derivatives</span>
    <span class="n">v_x_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># get ddu_y/dt2</span>
    <span class="n">v_y_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># momentum terms</span>
    <span class="k">if</span> <span class="n">body_force_function</span><span class="p">:</span>
        <span class="n">body_force_x</span><span class="p">,</span> <span class="n">body_force_y</span> <span class="o">=</span> <span class="n">body_force_function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">body_force_x</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_x_t</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">body_force_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_y_t</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_x_t</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_y_t</span>
    
   <span class="c1"># Coupling of stress rates</span>
    <span class="n">term_x_rate</span><span class="p">,</span> <span class="n">term_y_rate</span><span class="p">,</span> <span class="n">term_xy_rate</span> <span class="o">=</span> <span class="n">get_plane_strain_stress_rate_coupling</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Coupling of velocities</span>
    <span class="n">term_x_velocity</span><span class="p">,</span> <span class="n">term_y_velocity</span> <span class="o">=</span> <span class="n">get_velocity_coupling_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># material law</span>
    <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span> <span class="o">=</span> <span class="n">lin_iso_elasticity_plane_strain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">term_x_rate</span><span class="p">,</span> <span class="n">term_y_rate</span><span class="p">,</span> <span class="n">term_xy_rate</span><span class="p">,</span> <span class="n">term_x_velocity</span><span class="p">,</span> <span class="n">term_y_velocity</span><span class="p">,</span> <span class="n">term_x</span><span class="p">,</span> <span class="n">term_y</span><span class="p">,</span> <span class="n">term_xy</span> <span class="p">]</span></div>


<span class="c1">#################################################################################################################################################################################</span>
<span class="c1"># Equations for 3D elastodynamics</span>
<span class="c1">#################################################################################################################################################################################</span>
<div class="viewcode-block" id="pde_mixed_3d_time">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_3d_time">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_3d_time</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and generates the terms for PDE of the mixed-variable formulation in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points an time: x, y, z, t</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output: disp_x, disp_y, disp_z, sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    momentum_x, momentum_y, momentum_z, term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: tensor</span>
<span class="sd">        momentum_x, momentum_y, momentum_z: momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: difference between predicted stresses and calculated stresses in X, Y, Z, XY, YZ, and XZ directions</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Stress derivatives</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#sigma_xx_y = dde.grad.jacobian(y, x, i=3, j=1)</span>
    <span class="c1">#sigma_xx_z = dde.grad.jacobian(y, x, i=3, j=2)</span>
    
    <span class="c1">#sigma_yy_x = dde.grad.jacobian(y, x, i=4, j=0)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#sigma_yy_z = dde.grad.jacobian(y, x, i=4, j=2)</span>
    
    <span class="c1">#sigma_zz_x = dde.grad.jacobian(y, x, i=5, j=0)</span>
    <span class="c1">#sigma_zz_y = dde.grad.jacobian(y, x, i=5, j=1)</span>
    <span class="n">sigma_zz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#sigma_xy_z = dde.grad.jacobian(y, x, i=6, j=2)</span>
    
    <span class="c1">#sigma_yz_x = dde.grad.jacobian(y, x, i=7, j=0)</span>
    <span class="n">sigma_yz_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_yz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">sigma_xz_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#sigma_xz_y = dde.grad.jacobian(y, x, i=8, j=1)</span>
    <span class="n">sigma_xz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    
    <span class="c1"># get ddu_x/dt2</span>
    <span class="n">u_x_tt</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># component is u_x, tt is the fourth input which is time tt=&gt;ij</span>
    <span class="c1"># get ddu_y/dt2</span>
    <span class="n">u_y_tt</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># component is u_y, tt is the fourth input which is time tt=&gt;ij</span>
    <span class="c1"># get ddu_z/dt2</span>
    <span class="n">u_z_tt</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># component is u_z, tt is the fourth input which is time tt=&gt;ij</span>
    
    <span class="c1"># momentum terms</span>
    <span class="k">if</span> <span class="n">body_force_function</span><span class="p">:</span>
        <span class="n">body_force_x</span><span class="p">,</span> <span class="n">body_force_y</span><span class="p">,</span> <span class="n">body_force_z</span> <span class="o">=</span> <span class="n">body_force_function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">sigma_xz_z</span> <span class="o">+</span> <span class="n">body_force_x</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_x_tt</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">sigma_yz_z</span> <span class="o">+</span> <span class="n">body_force_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_y_tt</span>
        <span class="n">momentum_z</span> <span class="o">=</span> <span class="n">sigma_zz_z</span> <span class="o">+</span> <span class="n">sigma_xz_x</span> <span class="o">+</span> <span class="n">sigma_yz_y</span> <span class="o">+</span> <span class="n">body_force_z</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_z_tt</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">sigma_xz_z</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_x_tt</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">sigma_yz_z</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_y_tt</span>
        <span class="n">momentum_z</span> <span class="o">=</span> <span class="n">sigma_zz_z</span> <span class="o">+</span> <span class="n">sigma_xz_x</span> <span class="o">+</span> <span class="n">sigma_yz_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">u_z_tt</span>   

    <span class="c1"># Material law</span>
    <span class="n">term_xx</span><span class="p">,</span> <span class="n">term_yy</span><span class="p">,</span> <span class="n">term_zz</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">,</span> <span class="n">term_yz</span><span class="p">,</span> <span class="n">term_xz</span> <span class="o">=</span> <span class="n">get_stress_coupling</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">momentum_z</span><span class="p">,</span> <span class="n">term_xx</span><span class="p">,</span> <span class="n">term_yy</span><span class="p">,</span> <span class="n">term_zz</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">,</span> <span class="n">term_yz</span><span class="p">,</span> <span class="n">term_xz</span><span class="p">]</span></div>


<div class="viewcode-block" id="get_tractions_mixed_3d_spacetime">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_tractions_mixed_3d_spacetime">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_tractions_mixed_3d_spacetime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates traction components in the mixed formulation. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        x : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for coordinates of input points an time: x, y, z, t</span>
<span class="sd">        y : Placeholder (tensor)</span>
<span class="sd">            contains the placeholder for network output: disp_x, disp_y, disp_z, sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz</span>
<span class="sd">        X : np array</span>
<span class="sd">            Network input as numpy array (x,y,z,t)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Tx, Ty, Tz, Tn, Tt_1, Tt_2: tensor</span>
<span class="sd">            Traction components in cartesian (x,y,z) and polar coordinates (n (normal), t_1 (tangential 1), t_2 (tangential 2))</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">sigma_xx</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">sigma_yy</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">sigma_zz</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">sigma_xy</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">sigma_yz</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">sigma_xz</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
    
    <span class="n">normals</span><span class="p">,</span> <span class="n">tangentials_1</span><span class="p">,</span> <span class="n">tangentials_2</span><span class="p">,</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">calculate_boundary_normals_3D</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">spacetime_domain</span><span class="p">)</span>

    <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span> <span class="o">=</span> <span class="n">stress_to_traction_3d</span><span class="p">(</span><span class="n">sigma_xx</span><span class="p">,</span> <span class="n">sigma_yy</span><span class="p">,</span> <span class="n">sigma_zz</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">,</span> <span class="n">sigma_xz</span><span class="p">,</span> <span class="n">sigma_yz</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">tangentials_1</span><span class="p">,</span> <span class="n">tangentials_2</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span><span class="p">,</span> <span class="n">Tz</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tt_1</span><span class="p">,</span> <span class="n">Tt_2</span></div>


<span class="c1">#################################################################################################################################################################################</span>
<span class="c1"># Equations for 3D elastodynamics in case of stress-velocity mixed formulation approach</span>
<span class="c1">#################################################################################################################################################################################</span>
<div class="viewcode-block" id="elastic_strain_rate_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.elastic_strain_rate_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">elastic_strain_rate_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the strain tensor components in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    eps_xx, eps_yy, eps_zz, eps_xy, eps_yz, eps_xz: tensor</span>
<span class="sd">        contains the components of strain tensor in 3D</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Normal strain rates</span>
    <span class="n">eps_xx_rate</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">eps_yy_rate</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eps_zz_rate</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Shear strain rates</span>
    <span class="n">eps_xy_rate</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">eps_yz_rate</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">eps_xz_rate</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">eps_xx_rate</span><span class="p">,</span> <span class="n">eps_yy_rate</span><span class="p">,</span> <span class="n">eps_zz_rate</span><span class="p">,</span> <span class="n">eps_xy_rate</span><span class="p">,</span> <span class="n">eps_yz_rate</span><span class="p">,</span> <span class="n">eps_xz_rate</span> </div>


<div class="viewcode-block" id="stress_rate_tensor_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.stress_rate_tensor_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">stress_rate_tensor_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the stress tensor components in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output</span>

<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz: tensor</span>
<span class="sd">        contains the components of stress tensor in 3D</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">eps_xx_rate</span><span class="p">,</span> <span class="n">eps_yy_rate</span><span class="p">,</span> <span class="n">eps_zz_rate</span><span class="p">,</span> <span class="n">eps_xy_rate</span><span class="p">,</span> <span class="n">eps_yz_rate</span><span class="p">,</span> <span class="n">eps_xz_rate</span> <span class="o">=</span> <span class="n">elastic_strain_rate_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="n">nu</span><span class="p">,</span><span class="n">lame</span><span class="p">,</span><span class="n">shear</span><span class="p">,</span><span class="n">e_modul</span> <span class="o">=</span> <span class="n">problem_parameters</span><span class="p">()</span>
    
    <span class="c1"># calculate stress terms (constitutive law)</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">e_modul</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">))</span>
    
    <span class="n">sigma_xx_rate</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_xx_rate</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_yy_rate</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_zz_rate</span><span class="p">)</span>
    <span class="n">sigma_yy_rate</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_yy_rate</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_xx_rate</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_zz_rate</span><span class="p">)</span>
    <span class="n">sigma_zz_rate</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">eps_zz_rate</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_xx_rate</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">eps_yy_rate</span><span class="p">)</span>
    
    <span class="n">sigma_xy_rate</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps_xy_rate</span>
    <span class="n">sigma_yz_rate</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps_yz_rate</span>
    <span class="n">sigma_xz_rate</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps_xz_rate</span>

    <span class="k">return</span> <span class="n">sigma_xx_rate</span><span class="p">,</span> <span class="n">sigma_yy_rate</span><span class="p">,</span> <span class="n">sigma_zz_rate</span><span class="p">,</span> <span class="n">sigma_xy_rate</span><span class="p">,</span> <span class="n">sigma_yz_rate</span><span class="p">,</span> <span class="n">sigma_xz_rate</span></div>


<div class="viewcode-block" id="get_stress_rate_coupling_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_stress_rate_coupling_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_stress_rate_coupling_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the difference between predicted stresses and calculated stresses based on linear isotropic material law and predicted displacements in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output: disp_x, disp_y, disp_z, sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: tensor</span>
<span class="sd">        difference between predicted stresses and calculated stresses in 3D</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># get the stress rate from velocity fields</span>
    <span class="n">sigma_xx_rate_v</span><span class="p">,</span> <span class="n">sigma_yy_rate_v</span><span class="p">,</span> <span class="n">sigma_zz_rate_v</span><span class="p">,</span> <span class="n">sigma_xy_rate_v</span><span class="p">,</span> <span class="n">sigma_yz_rate_v</span><span class="p">,</span> <span class="n">sigma_xz_rate_v</span> <span class="o">=</span> <span class="n">stress_rate_tensor_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># get the stress rate from stress fields</span>
    <span class="n">sigma_xx_rate_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">sigma_yy_rate_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">sigma_zz_rate_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">sigma_xy_rate_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">sigma_yz_rate_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">sigma_xz_rate_s</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">term_xx_rate</span> <span class="o">=</span> <span class="n">sigma_xx_rate_v</span> <span class="o">-</span> <span class="n">sigma_xx_rate_s</span>
    <span class="n">term_yy_rate</span> <span class="o">=</span> <span class="n">sigma_yy_rate_v</span> <span class="o">-</span> <span class="n">sigma_yy_rate_s</span>
    <span class="n">term_zz_rate</span> <span class="o">=</span> <span class="n">sigma_zz_rate_v</span> <span class="o">-</span> <span class="n">sigma_zz_rate_s</span>
    <span class="n">term_xy_rate</span> <span class="o">=</span> <span class="n">sigma_xy_rate_v</span> <span class="o">-</span> <span class="n">sigma_xy_rate_s</span>
    <span class="n">term_yz_rate</span> <span class="o">=</span> <span class="n">sigma_yz_rate_v</span> <span class="o">-</span> <span class="n">sigma_yz_rate_s</span>
    <span class="n">term_xz_rate</span> <span class="o">=</span> <span class="n">sigma_xz_rate_v</span> <span class="o">-</span> <span class="n">sigma_xz_rate_s</span>
    
    <span class="k">return</span> <span class="n">term_xx_rate</span><span class="p">,</span> <span class="n">term_yy_rate</span><span class="p">,</span> <span class="n">term_zz_rate</span><span class="p">,</span> <span class="n">term_xy_rate</span><span class="p">,</span> <span class="n">term_yz_rate</span><span class="p">,</span> <span class="n">term_xz_rate</span></div>


<div class="viewcode-block" id="get_velocity_coupling_3d">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.get_velocity_coupling_3d">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_velocity_coupling_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="c1"># coupling of displacement and velocities</span>
    <span class="n">u_x_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">u_y_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">u_z_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">v_x</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">v_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">v_z</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">11</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>
    
    <span class="n">term_x_velocity</span> <span class="o">=</span> <span class="n">u_x_t</span> <span class="o">-</span> <span class="n">v_x</span>
    <span class="n">term_y_velocity</span> <span class="o">=</span> <span class="n">u_y_t</span> <span class="o">-</span> <span class="n">v_y</span>
    <span class="n">term_z_velocity</span> <span class="o">=</span> <span class="n">u_z_t</span> <span class="o">-</span> <span class="n">v_z</span>
    
    <span class="k">return</span> <span class="n">term_x_velocity</span><span class="p">,</span> <span class="n">term_y_velocity</span><span class="p">,</span> <span class="n">term_z_velocity</span></div>


<div class="viewcode-block" id="pde_mixed_velocity_3d_time">
<a class="viewcode-back" href="../../../api/utils.elasticity.html#utils.elasticity.elasticity_utils.pde_mixed_velocity_3d_time">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pde_mixed_velocity_3d_time</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the momentum equation using predicted stresses and generates the terms for PDE of the mixed-variable formulation in 3D.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for coordinates of input points an time: x, y, z, t</span>
<span class="sd">    y : Placeholder (tensor)</span>
<span class="sd">        contains the placeholder for network output: disp_x, disp_y, disp_z, sigma_xx, sigma_yy, sigma_zz, sigma_xy, sigma_yz, sigma_xz</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    momentum_x, momentum_y, momentum_z, term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: tensor</span>
<span class="sd">        momentum_x, momentum_y, momentum_z: momentum terms based on derivatives of predicted stresses</span>
<span class="sd">        term_xx, term_yy, term_zz, term_xy, term_yz, term_xz: difference between predicted stresses and calculated stresses in X, Y, Z, XY, YZ, and XZ directions</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Stress derivatives</span>
    <span class="n">sigma_xx_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#sigma_xx_y = dde.grad.jacobian(y, x, i=3, j=1)</span>
    <span class="c1">#sigma_xx_z = dde.grad.jacobian(y, x, i=3, j=2)</span>
    
    <span class="c1">#sigma_yy_x = dde.grad.jacobian(y, x, i=4, j=0)</span>
    <span class="n">sigma_yy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#sigma_yy_z = dde.grad.jacobian(y, x, i=4, j=2)</span>
    
    <span class="c1">#sigma_zz_x = dde.grad.jacobian(y, x, i=5, j=0)</span>
    <span class="c1">#sigma_zz_y = dde.grad.jacobian(y, x, i=5, j=1)</span>
    <span class="n">sigma_zz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">sigma_xy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_xy_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#sigma_xy_z = dde.grad.jacobian(y, x, i=6, j=2)</span>
    
    <span class="c1">#sigma_yz_x = dde.grad.jacobian(y, x, i=7, j=0)</span>
    <span class="n">sigma_yz_y</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sigma_yz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">sigma_xz_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#sigma_xz_y = dde.grad.jacobian(y, x, i=8, j=1)</span>
    <span class="n">sigma_xz_z</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># get velocity derivatives</span>
    <span class="n">v_x_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># get ddu_y/dt2</span>
    <span class="n">v_y_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># get ddu_y/dt2</span>
    <span class="n">v_z_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="c1"># momentum terms</span>
    <span class="k">if</span> <span class="n">body_force_function</span><span class="p">:</span>
        <span class="n">body_force_x</span><span class="p">,</span> <span class="n">body_force_y</span><span class="p">,</span> <span class="n">body_force_z</span> <span class="o">=</span> <span class="n">body_force_function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">sigma_xz_z</span> <span class="o">+</span> <span class="n">body_force_x</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_x_t</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">sigma_yz_z</span> <span class="o">+</span> <span class="n">body_force_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_y_t</span>
        <span class="n">momentum_z</span> <span class="o">=</span> <span class="n">sigma_zz_z</span> <span class="o">+</span> <span class="n">sigma_xz_x</span> <span class="o">+</span> <span class="n">sigma_yz_y</span> <span class="o">+</span> <span class="n">body_force_z</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_z_t</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">momentum_x</span> <span class="o">=</span> <span class="n">sigma_xx_x</span> <span class="o">+</span> <span class="n">sigma_xy_y</span> <span class="o">+</span> <span class="n">sigma_xz_z</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_x_t</span>
        <span class="n">momentum_y</span> <span class="o">=</span> <span class="n">sigma_yy_y</span> <span class="o">+</span> <span class="n">sigma_xy_x</span> <span class="o">+</span> <span class="n">sigma_yz_z</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_y_t</span>
        <span class="n">momentum_z</span> <span class="o">=</span> <span class="n">sigma_zz_z</span> <span class="o">+</span> <span class="n">sigma_xz_x</span> <span class="o">+</span> <span class="n">sigma_yz_y</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">v_z_t</span>   

    <span class="c1"># Coupling of stress rates</span>
    <span class="n">term_xx_rate</span><span class="p">,</span> <span class="n">term_yy_rate</span><span class="p">,</span> <span class="n">term_zz_rate</span><span class="p">,</span> <span class="n">term_xy_rate</span><span class="p">,</span> <span class="n">term_yz_rate</span><span class="p">,</span> <span class="n">term_xz_rate</span> <span class="o">=</span> <span class="n">get_stress_rate_coupling_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Coupling of velocities</span>
    <span class="n">term_x_velocity</span><span class="p">,</span> <span class="n">term_y_velocity</span><span class="p">,</span> <span class="n">term_z_velocity</span> <span class="o">=</span> <span class="n">get_velocity_coupling_3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Material law</span>
    <span class="n">term_xx</span><span class="p">,</span> <span class="n">term_yy</span><span class="p">,</span> <span class="n">term_zz</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">,</span> <span class="n">term_yz</span><span class="p">,</span> <span class="n">term_xz</span> <span class="o">=</span> <span class="n">get_stress_coupling</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">momentum_x</span><span class="p">,</span> <span class="n">momentum_y</span><span class="p">,</span> <span class="n">momentum_z</span><span class="p">,</span> 
            <span class="n">term_xx_rate</span><span class="p">,</span> <span class="n">term_yy_rate</span><span class="p">,</span> <span class="n">term_zz_rate</span><span class="p">,</span> <span class="n">term_xy_rate</span><span class="p">,</span> <span class="n">term_yz_rate</span><span class="p">,</span> <span class="n">term_xz_rate</span><span class="p">,</span> 
            <span class="n">term_x_velocity</span><span class="p">,</span> <span class="n">term_y_velocity</span><span class="p">,</span> <span class="n">term_z_velocity</span><span class="p">,</span>
            <span class="n">term_xx</span><span class="p">,</span> <span class="n">term_yy</span><span class="p">,</span> <span class="n">term_zz</span><span class="p">,</span> <span class="n">term_xy</span><span class="p">,</span> <span class="n">term_yz</span><span class="p">,</span> <span class="n">term_xz</span><span class="p">]</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">CompSim-PINN</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=imcs-compsim&repo=pinns_for_comp_mech&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Institute for Mathematics and Computer-Based Simulation (IMCS).
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    
    <a href="https://github.com/imcs-compsim/pinns_for_comp_mech" class="github">
        <img src="../../../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>