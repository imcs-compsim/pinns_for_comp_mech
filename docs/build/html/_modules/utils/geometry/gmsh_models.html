<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>utils.geometry.gmsh_models &#8212; CompSim-PINN 2025.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=14229d9d"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for utils.geometry.gmsh_models</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<div class="viewcode-block" id="QuarterCirclewithHole">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.QuarterCirclewithHole">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">QuarterCirclewithHole</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="QuarterCirclewithHole.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.QuarterCirclewithHole.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates the quarter of a circle including a hole.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Parameters</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span>

        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="n">r1</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthFromCurvature&quot;, 1);</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;QuarterCirclewithHole&quot;</span><span class="p">)</span>

        <span class="c1"># Actually allows for a filled ellipse.</span>
        <span class="c1"># create the small disk</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
        <span class="c1"># create the large disk</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="c1"># create the rectangle</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="c1"># substract the small disk from the large one</span>
        <span class="n">s4</span><span class="p">,</span> <span class="n">ss4</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)])</span>
        <span class="c1"># intersect it with the rectangle</span>
        <span class="n">factory</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">s4</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s3</span><span class="p">)])</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="RingQuarter">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingQuarter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RingQuarter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="RingQuarter.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingQuarter.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates the quarter of a circle including a hole.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Parameters</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span>

        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="n">r1</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthFromCurvature&quot;, 1);</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;QuarterCirclewithHole&quot;</span><span class="p">)</span>

        <span class="c1"># Actually allows for a filled ellipse.</span>
        <span class="c1"># create the small disk</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
        <span class="c1"># create the large disk</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="c1"># create the rectangle</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="o">-</span><span class="n">r2</span><span class="p">,</span> <span class="o">-</span><span class="n">r2</span><span class="p">)</span>
        <span class="c1"># substract the small disk from the large one</span>
        <span class="n">s4</span><span class="p">,</span> <span class="n">ss4</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)])</span>
        <span class="c1"># intersect it with the rectangle</span>
        <span class="n">factory</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">s4</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s3</span><span class="p">)])</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="QuarterTorus3D">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.QuarterTorus3D">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">QuarterTorus3D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">major_radius</span><span class="p">,</span> <span class="n">tube_radius</span><span class="p">,</span>
                 <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># [x, y, z]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">major_radius</span> <span class="o">=</span> <span class="n">major_radius</span>  <span class="c1"># Distance from center to tube center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tube_radius</span> <span class="o">=</span> <span class="n">tube_radius</span>    <span class="c1"># Radius of tube</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="QuarterTorus3D.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.QuarterTorus3D.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a 3D half torus geometry and meshes it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : bool</span>
<span class="sd">            Whether to open the mesh in the Gmsh GUI after generation.</span>
<span class="sd">        write_mesh_file : bool</span>
<span class="sd">            Whether to write the mesh to a .msh file.</span>
<span class="sd">        filename : str</span>
<span class="sd">            The name of the file to write the mesh to (if write_mesh_file=True).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model : The gmsh model instance.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">major_radius</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tube_radius</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;HalfTorus&quot;</span><span class="p">)</span>

        <span class="c1"># Apply mesh options</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># 1. Create full torus</span>
        <span class="n">torus</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addTorus</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">factory</span><span class="o">.</span><span class="n">rotate</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="n">torus</span><span class="p">)],</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Rotate 90° CCW about Z</span>

        <span class="c1"># 2. Create a cutting box to keep only half</span>
        <span class="n">cut_box</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addBox</span><span class="p">(</span><span class="n">xc</span> <span class="o">-</span> <span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="p">),</span> <span class="n">yc</span> <span class="o">-</span> <span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="p">),</span> <span class="n">zc</span><span class="p">,</span>
                                 <span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span><span class="p">)</span>

        <span class="c1"># 3. Cut torus with box to get half-torus</span>
        <span class="n">cut_volume</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="n">torus</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="n">cut_box</span><span class="p">)],</span>
                                    <span class="n">removeObject</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># 4. Synchronize and generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="RingQuarter3D">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingQuarter3D">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RingQuarter3D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">num_elements</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span> <span class="o">=</span> <span class="n">num_elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="RingQuarter3D.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingQuarter3D.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a quarter of a ring with a hole, extruded into 3D and meshed with hexahedral elements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : bool</span>
<span class="sd">            Whether to open the mesh in the Gmsh GUI after generation.</span>
<span class="sd">        write_mesh_file : bool</span>
<span class="sd">            Whether to write the mesh to a .msh file.</span>
<span class="sd">        filename : str</span>
<span class="sd">            The name of the file to write the mesh to (if write_mesh_file=True).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model : Object</span>
<span class="sd">            The gmsh model instance.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="n">r1</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;QuarterRingWithHole&quot;</span><span class="p">)</span>

        <span class="c1"># Set mesh size</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.RecombineAll&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.SubdivisionAlgorithm&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># Construct 2D geometry: quarter ring with hole</span>
        <span class="n">s_inner</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
        <span class="n">s_outer</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="c1"># add the rectangle</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="o">-</span><span class="n">r2</span><span class="p">,</span> <span class="o">-</span><span class="n">r2</span><span class="p">)</span>                

        <span class="n">ring_surface</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s_outer</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s_inner</span><span class="p">)],</span> <span class="n">removeObject</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">quarter_ring</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">ring_surface</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">rect</span><span class="p">)],</span> <span class="n">removeObject</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Recombine for quad mesh</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">quarter_ring</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setRecombine</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Extrude into 3D (along z-axis)</span>
        <span class="n">thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">volumes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">quarter_ring</span><span class="p">:</span>
            <span class="n">extruded</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">extrude</span><span class="p">([</span><span class="n">s</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">numElements</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span><span class="p">],</span> <span class="n">recombine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">volumes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">extruded</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">])</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate 3D mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="RingHalf3D">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingHalf3D">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RingHalf3D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">num_elements</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span> <span class="o">=</span> <span class="n">num_elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="RingHalf3D.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingHalf3D.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a quarter of a ring with a hole, extruded into 3D and meshed with hexahedral elements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : bool</span>
<span class="sd">            Whether to open the mesh in the Gmsh GUI after generation.</span>
<span class="sd">        write_mesh_file : bool</span>
<span class="sd">            Whether to write the mesh to a .msh file.</span>
<span class="sd">        filename : str</span>
<span class="sd">            The name of the file to write the mesh to (if write_mesh_file=True).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model : Object</span>
<span class="sd">            The gmsh model instance.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="n">r1</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;QuarterRingWithHole&quot;</span><span class="p">)</span>

        <span class="c1"># Set mesh size</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.RecombineAll&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.SubdivisionAlgorithm&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># Construct 2D geometry: quarter ring with hole</span>
        <span class="n">s_inner</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
        <span class="n">s_outer</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">xc</span> <span class="o">+</span> <span class="n">r2</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r2</span><span class="p">)</span>

        <span class="n">ring_surface</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s_outer</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s_inner</span><span class="p">)],</span> <span class="n">removeObject</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">quarter_ring</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">ring_surface</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">rect</span><span class="p">)],</span> <span class="n">removeObject</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Recombine for quad mesh</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">quarter_ring</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setRecombine</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Extrude into 3D (along z-axis)</span>
        <span class="n">thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">volumes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">quarter_ring</span><span class="p">:</span>
            <span class="n">extruded</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">extrude</span><span class="p">([</span><span class="n">s</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">numElements</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span><span class="p">],</span> <span class="n">recombine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">volumes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">extruded</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">])</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate 3D mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


    
<div class="viewcode-block" id="RingHalf">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingHalf">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RingHalf</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="RingHalf.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.RingHalf.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates the quarter of a circle including a hole.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Parameters</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span>

        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="n">r1</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthFromCurvature&quot;, 1);</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;QuarterCirclewithHole&quot;</span><span class="p">)</span>

        <span class="c1"># Actually allows for a filled ellipse.</span>
        <span class="c1"># create the small disk</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
        <span class="c1"># create the large disk</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="c1"># create the rectangle</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">xc</span><span class="o">+</span><span class="n">r2</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r2</span><span class="p">)</span>
        <span class="c1"># substract the small disk from the large one</span>
        <span class="n">s4</span><span class="p">,</span> <span class="n">ss4</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)])</span>
        <span class="c1"># intersect it with the rectangle</span>
        <span class="n">factory</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">s4</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s3</span><span class="p">)])</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="CirclewithHole">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.CirclewithHole">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CirclewithHole</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="CirclewithHole.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.CirclewithHole.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a circle including a hole.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Parameters</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span>

        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="n">r1</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthFromCurvature&quot;, 1);</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;CirclewithHole&quot;</span><span class="p">)</span>

        <span class="c1"># Actually allows for a filled ellipse.</span>
        <span class="c1"># create the small disk</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
        <span class="c1"># create the large disk</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="c1"># substract the small disk from the large one</span>
        <span class="n">factory</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)])</span>
        <span class="c1"># intersect it with the rectangle</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Block_2D">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Block_2D">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Block_2D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord_left_corner</span><span class="p">,</span> <span class="n">coord_right_corner</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span> <span class="o">=</span> <span class="n">coord_left_corner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span> <span class="o">=</span> <span class="n">coord_right_corner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="Block_2D.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Block_2D.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a circle including a hole.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Parameters</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">x1</span><span class="o">&gt;</span><span class="n">x0</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">y1</span><span class="o">&gt;</span><span class="n">y0</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span> 
        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthFromCurvature&quot;, 1);</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Rectangle&quot;</span><span class="p">)</span>

        <span class="n">factory</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>

    
<span class="c1"># class Block_3D_hex(object):</span>
<span class="c1">#     def __init__(self, length, height, width, seed_l=10, seed_w=10, seed_h=10):</span>
<span class="c1">#         self.length = length</span>
<span class="c1">#         self.height = height</span>
<span class="c1">#         self.width = width</span>
<span class="c1">#         self.seed_l = seed_l</span>
<span class="c1">#         self.seed_w = seed_w</span>
<span class="c1">#         self.seed_h = seed_h</span>
    
<span class="c1">#     def generateGmshModel(self, visualize_mesh=False):</span>
<span class="c1">#         &#39;&#39;&#39;</span>
<span class="c1">#         Generates a 3D block with a structured hex mesh.</span>

<span class="c1">#         Parameters</span>
<span class="c1">#         ----------</span>
<span class="c1">#         visualize_mesh : boolean</span>
<span class="c1">#             a booelan value to show the mesh using Gmsh or not</span>
<span class="c1">#         Returns </span>
<span class="c1">#         -------</span>
<span class="c1">#         gmsh_model: Object</span>
<span class="c1">#             gmsh model </span>
<span class="c1">#         &#39;&#39;&#39;</span>
<span class="c1">#         # Parameters</span>
<span class="c1">#         length= self.length #in x direction</span>
<span class="c1">#         width = self.width #in y direction</span>
<span class="c1">#         height = self.height #in z direction</span>
        
<span class="c1">#         seed_l = self.seed_l</span>
<span class="c1">#         seed_w = self.seed_w</span>
<span class="c1">#         seed_h = self.seed_h</span>
        
<span class="c1">#         # create gmsh model instance</span>
<span class="c1">#         gmsh_model = gmsh.model</span>

<span class="c1">#         # initialize gmsh</span>
<span class="c1">#         gmsh.initialize(sys.argv)</span>
        
<span class="c1">#         # Add points (corners of the cube)</span>
<span class="c1">#         p1 = gmsh.model.geo.addPoint(0, 0, 0)</span>
<span class="c1">#         p2 = gmsh.model.geo.addPoint(length, 0, 0)</span>
<span class="c1">#         p3 = gmsh.model.geo.addPoint(length, width, 0)</span>
<span class="c1">#         p4 = gmsh.model.geo.addPoint(0, width, 0)</span>
<span class="c1">#         p5 = gmsh.model.geo.addPoint(0, 0, height)</span>
<span class="c1">#         p6 = gmsh.model.geo.addPoint(length, 0, height)</span>
<span class="c1">#         p7 = gmsh.model.geo.addPoint(length, width, height)</span>
<span class="c1">#         p8 = gmsh.model.geo.addPoint(0, width, height)</span>

<span class="c1">#         # Add lines (edges of the cube)</span>
<span class="c1">#         l1 = gmsh.model.geo.addLine(p1, p2)</span>
<span class="c1">#         l2 = gmsh.model.geo.addLine(p2, p3)</span>
<span class="c1">#         l3 = gmsh.model.geo.addLine(p3, p4)</span>
<span class="c1">#         l4 = gmsh.model.geo.addLine(p4, p1)</span>

<span class="c1">#         l5 = gmsh.model.geo.addLine(p5, p6)</span>
<span class="c1">#         l6 = gmsh.model.geo.addLine(p6, p7)</span>
<span class="c1">#         l7 = gmsh.model.geo.addLine(p7, p8)</span>
<span class="c1">#         l8 = gmsh.model.geo.addLine(p8, p5)</span>

<span class="c1">#         l9 = gmsh.model.geo.addLine(p1, p5)</span>
<span class="c1">#         l10 = gmsh.model.geo.addLine(p2, p6)</span>
<span class="c1">#         l11 = gmsh.model.geo.addLine(p3, p7)</span>
<span class="c1">#         l12 = gmsh.model.geo.addLine(p4, p8)</span>

<span class="c1">#         # Define surfaces (6 faces of the cube)</span>
<span class="c1">#         s1 = gmsh.model.geo.addPlaneSurface([gmsh.model.geo.addCurveLoop([-l1, -l4, -l3, -l2])]) #bottom</span>
<span class="c1">#         s2 = gmsh.model.geo.addPlaneSurface([gmsh.model.geo.addCurveLoop([l5, l6, l7, l8])]) # top</span>
<span class="c1">#         s3 = gmsh.model.geo.addPlaneSurface([gmsh.model.geo.addCurveLoop([l1, l10, -l5, -l9])]) #front</span>
<span class="c1">#         s4 = gmsh.model.geo.addPlaneSurface([gmsh.model.geo.addCurveLoop([l2, l11, -l6, -l10])]) # right</span>
<span class="c1">#         s5 = gmsh.model.geo.addPlaneSurface([gmsh.model.geo.addCurveLoop([l3, l12, -l7, -l11])]) # back</span>
<span class="c1">#         s6 = gmsh.model.geo.addPlaneSurface([gmsh.model.geo.addCurveLoop([l4, l9, -l8, -l12])]) # left</span>

<span class="c1">#         # Define the volume (body of the cube)</span>
<span class="c1">#         gmsh.model.geo.addSurfaceLoop([s1, s2, s3, s4, s5, s6], 1)</span>
<span class="c1">#         volume = gmsh.model.geo.addVolume([1])</span>

<span class="c1">#         # Synchronize the geometry</span>
<span class="c1">#         gmsh.model.geo.synchronize()</span>

<span class="c1">#         # Set transfinite lines (structured mesh with hexahedral elements)</span>
<span class="c1">#         # Define the number of divisions along each edge of the cube (e.g., 10 divisions)</span>

<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l1, seed_l)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l2, seed_w)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l3, seed_l)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l4, seed_w)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l5, seed_l)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l6, seed_w)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l7, seed_l)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l8, seed_w)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l9, seed_h)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l10, seed_h)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l11, seed_h)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteCurve(l12, seed_h)</span>

<span class="c1">#         # Set transfinite surfaces for all 6 faces</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteSurface(s1)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteSurface(s2)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteSurface(s3)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteSurface(s4)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteSurface(s5)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteSurface(s6)</span>

<span class="c1">#         # Set transfinite volume (the entire cube)</span>
<span class="c1">#         gmsh.model.mesh.setTransfiniteVolume(volume)</span>

<span class="c1">#         # Set recombination to generate hexahedral elements</span>
<span class="c1">#         gmsh.model.mesh.setRecombine(2, s1)</span>
<span class="c1">#         gmsh.model.mesh.setRecombine(2, s2)</span>
<span class="c1">#         gmsh.model.mesh.setRecombine(2, s3)</span>
<span class="c1">#         gmsh.model.mesh.setRecombine(2, s4)</span>
<span class="c1">#         gmsh.model.mesh.setRecombine(2, s5)</span>
<span class="c1">#         gmsh.model.mesh.setRecombine(2, s6)</span>
        
<span class="c1">#         # Synchronize the geometry</span>
<span class="c1">#         #gmsh_model.geo.synchronize()</span>
<span class="c1">#         gmsh_model.occ.synchronize()</span>

<span class="c1">#         # generate mesh</span>
<span class="c1">#         gmsh_model.mesh.generate(3)</span>

<span class="c1">#         if visualize_mesh:</span>
<span class="c1">#             if &#39;-nopopup&#39; not in sys.argv:</span>
<span class="c1">#                 gmsh.fltk.run()</span>

<span class="c1">#         return gmsh_model</span>
    
<span class="c1"># class Block_3D_hex(object):</span>
<span class="c1">#     def __init__(self, coord_left_corner, coord_right_corner, mesh_size=0.15, gmsh_options=None):</span>
<span class="c1">#         self.coord_left_corner = coord_left_corner</span>
<span class="c1">#         self.coord_right_corner = coord_right_corner</span>
<span class="c1">#         self.mesh_size = mesh_size</span>
<span class="c1">#         self.gmsh_options = gmsh_options</span>

<span class="c1">#     def generateGmshModel(self, visualize_mesh=False):</span>
<span class="c1">#         &#39;&#39;&#39;</span>
<span class="c1">#         Generates a 3D block with structured hexahedral mesh.</span>

<span class="c1">#         Parameters</span>
<span class="c1">#         ----------</span>
<span class="c1">#         visualize_mesh : boolean</span>
<span class="c1">#             A boolean value to show the mesh using Gmsh or not</span>
<span class="c1">#         Returns </span>
<span class="c1">#         -------</span>
<span class="c1">#         gmsh_model: Object</span>
<span class="c1">#             Gmsh model </span>
<span class="c1">#         &#39;&#39;&#39;</span>

<span class="c1">#         # Parameters</span>
<span class="c1">#         x0 = self.coord_left_corner[0]</span>
<span class="c1">#         y0 = self.coord_left_corner[1]</span>
<span class="c1">#         z0 = self.coord_left_corner[2]</span>
<span class="c1">#         x1 = self.coord_right_corner[0]</span>
<span class="c1">#         y1 = self.coord_right_corner[1]</span>
<span class="c1">#         z1 = self.coord_right_corner[2]</span>
<span class="c1">#         assert(x1 &gt; x0)</span>
<span class="c1">#         assert(y1 &gt; y0)</span>
<span class="c1">#         assert(z1 &gt; z0)</span>
<span class="c1">#         l = x1 - x0</span>
<span class="c1">#         h = y1 - y0</span>
<span class="c1">#         w = z1 - z0</span>

<span class="c1">#         # Mesh size.</span>
<span class="c1">#         lcar = self.mesh_size * min(h, l, w)</span>

<span class="c1">#         # Create gmsh model instance</span>
<span class="c1">#         gmsh_model = gmsh.model</span>
<span class="c1">#         factory = gmsh_model.occ</span>

<span class="c1">#         # Initialize gmsh</span>
<span class="c1">#         gmsh.initialize(sys.argv)</span>

<span class="c1">#         gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthMin&quot;, lcar)</span>
<span class="c1">#         gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthMax&quot;, lcar)</span>

<span class="c1">#         if self.gmsh_options:</span>
<span class="c1">#             for command, value in self.gmsh_options.items():</span>
<span class="c1">#                 if type(value).__name__ == &#39;str&#39;:</span>
<span class="c1">#                     gmsh.option.setString(command, value)</span>
<span class="c1">#                 else:</span>
<span class="c1">#                     gmsh.option.setNumber(command, value)</span>

<span class="c1">#         # Create box</span>
<span class="c1">#         gmsh_model.add(&quot;Box&quot;)</span>
<span class="c1">#         box = factory.addBox(x0, y0, z0, l, h, w)</span>

<span class="c1">#         # Synchronize geometry</span>
<span class="c1">#         gmsh_model.occ.synchronize()</span>

<span class="c1">#         # Set transfinite lines to enforce structured mesh</span>
<span class="c1">#         # Assuming that the geometry is a simple block</span>
<span class="c1">#         volumes = gmsh_model.getEntities(3)</span>
<span class="c1">#         surfaces = gmsh_model.getEntities(2)</span>
<span class="c1">#         curves = gmsh_model.getEntities(1)</span>

<span class="c1">#         # Apply transfinite meshing to all curves (edges of the box)</span>
<span class="c1">#         for curve in curves:</span>
<span class="c1">#             gmsh_model.mesh.setTransfiniteCurve(curve[1], 10)  # Adjust 10 for more refinement</span>

<span class="c1">#         # Apply transfinite meshing to all surfaces</span>
<span class="c1">#         for surface in surfaces:</span>
<span class="c1">#             gmsh_model.mesh.setTransfiniteSurface(surface[1])</span>

<span class="c1">#         # Apply transfinite meshing to the volume</span>
<span class="c1">#         for volume in volumes:</span>
<span class="c1">#             gmsh_model.mesh.setTransfiniteVolume(volume[1])</span>

<span class="c1">#         # Recombine surfaces to convert triangular elements to quadrilateral</span>
<span class="c1">#         for surface in surfaces:</span>
<span class="c1">#             gmsh_model.mesh.setRecombine(2, surface[1])</span>

<span class="c1">#         # Recombine the volume to create hexahedral elements</span>
<span class="c1">#         for volume in volumes:</span>
<span class="c1">#             gmsh_model.mesh.setRecombine(3, volume[1])</span>

<span class="c1">#         # Synchronize geometry</span>
<span class="c1">#         gmsh_model.occ.synchronize()</span>

<span class="c1">#         # Generate mesh</span>
<span class="c1">#         gmsh_model.mesh.generate(3)</span>

<span class="c1">#         if visualize_mesh:</span>
<span class="c1">#             if &#39;-nopopup&#39; not in sys.argv:</span>
<span class="c1">#                 gmsh.fltk.run()</span>

<span class="c1">#         return gmsh_model</span>

<div class="viewcode-block" id="SphereEighthHertzian">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.SphereEighthHertzian">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SphereEighthHertzian</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>

<div class="viewcode-block" id="SphereEighthHertzian.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.SphereEighthHertzian.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;EighthSphere&quot;</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">occ</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># Full sphere</span>
        <span class="n">sphere</span> <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>

        <span class="c1"># Box to cut 1/8 (positive x, y, z)</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">addBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>

        <span class="c1"># Intersect sphere with positive octant box</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">intersect</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sphere</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="n">box</span><span class="p">)],</span> <span class="n">removeObject</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Synchronize CAD</span>
        <span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Define mesh size field: Distance to sharp corner (origin)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;NodesList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># Node 1 = origin corner</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Sampling&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="mf">0.03</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Generate 3D mesh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span></div>
</div>


<div class="viewcode-block" id="Sphere_hertzian">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Sphere_hertzian">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Sphere_hertzian</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    
<div class="viewcode-block" id="Sphere_hertzian.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Sphere_hertzian.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Initialize Gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Create Gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="c1"># Create a new model</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Sphere_hertzian&quot;</span><span class="p">)</span>

        <span class="c1"># Import the STEP file</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">importShapes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Synchronize the CAD model with Gmsh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Identify the bottom edges (curves) and increase the number of divisions</span>
        <span class="c1"># You can retrieve curve (edge) IDs and set the desired number of seeds (divisions)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># print(&quot;Curves:&quot;, curves)  # List the curves (edges) to identify the ones at the bottom</span>

        <span class="c1"># Set more divisions on the bottom curves</span>
        <span class="c1"># Replace curve IDs with the actual curve IDs from the geometry</span>
        <span class="c1"># To find correct edges: just visualize it</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">]:</span>  
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]:</span>  
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">]:</span>  
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Sphere_hertzian_reverted">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Sphere_hertzian_reverted">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Sphere_hertzian_reverted</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    
<div class="viewcode-block" id="Sphere_hertzian_reverted.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Sphere_hertzian_reverted.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Initialize Gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Create Gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="c1"># Create a new model</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Sphere_hertzian&quot;</span><span class="p">)</span>

        <span class="c1"># Import the STEP file</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">importShapes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Synchronize the CAD model with Gmsh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Identify the bottom edges (curves) and increase the number of divisions</span>
        <span class="c1"># You can retrieve curve (edge) IDs and set the desired number of seeds (divisions)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># print(&quot;Curves:&quot;, curves)  # List the curves (edges) to identify the ones at the bottom</span>

        <span class="c1"># Set more divisions on the bottom curves</span>
        <span class="c1"># Replace curve IDs with the actual curve IDs from the geometry</span>
        <span class="c1"># To find correct edges: just visualize it</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]:</span> 
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">]:</span> 
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">16</span><span class="p">]:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>

    
<div class="viewcode-block" id="Half_sphere_hertzian">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Half_sphere_hertzian">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Half_sphere_hertzian</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    
<div class="viewcode-block" id="Half_sphere_hertzian.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Half_sphere_hertzian.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Initialize Gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Create Gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="c1"># Create a new model</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Sphere_hertzian&quot;</span><span class="p">)</span>

        <span class="c1"># Import the STEP file</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">importShapes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Synchronize the CAD model with Gmsh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Identify the bottom edges (curves) and increase the number of divisions</span>
        <span class="c1"># You can retrieve curve (edge) IDs and set the desired number of seeds (divisions)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># print(&quot;Curves:&quot;, curves)  # List the curves (edges) to identify the ones at the bottom</span>

        <span class="c1"># Set more divisions on the bottom curves</span>
        <span class="c1"># Replace curve IDs with the actual curve IDs from the geometry</span>
        <span class="c1"># To find correct edges: just visualize it</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">]:</span> 
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">13</span><span class="p">]:</span> 
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]:</span> 
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c1"># for curve_id in [1,4,14]: </span>
        <span class="c1">#     gmsh.model.mesh.setTransfiniteCurve(curve_id, 5)</span>
        <span class="c1"># for curve_id in [5,12,16]:</span>
        <span class="c1">#     gmsh.model.mesh.setTransfiniteCurve(curve_id, 30)</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Half_sphere_hertzian2">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Half_sphere_hertzian2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Half_sphere_hertzian2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    
<div class="viewcode-block" id="Half_sphere_hertzian2.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Half_sphere_hertzian2.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Initialize Gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Create Gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="c1"># Create a new model</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Sphere_hertzian&quot;</span><span class="p">)</span>

        <span class="c1"># Import the STEP file</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">importShapes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Synchronize the CAD model with Gmsh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Identify the bottom edges (curves) and increase the number of divisions</span>
        <span class="c1"># You can retrieve curve (edge) IDs and set the desired number of seeds (divisions)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># print(&quot;Curves:&quot;, curves)  # List the curves (edges) to identify the ones at the bottom</span>

        <span class="c1"># Set more divisions on the bottom curves</span>
        <span class="c1"># Replace curve IDs with the actual curve IDs from the geometry</span>
        <span class="c1"># To find correct edges: just visualize it</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">]:</span> 
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">14</span><span class="p">]:</span> 
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c1"># for curve_id in [1,4,14]: </span>
        <span class="c1">#     gmsh.model.mesh.setTransfiniteCurve(curve_id, 5)</span>
        <span class="c1"># for curve_id in [5,12,16]:</span>
        <span class="c1">#     gmsh.model.mesh.setTransfiniteCurve(curve_id, 30)</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Geom_step_to_gmsh">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Geom_step_to_gmsh">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Geom_step_to_gmsh</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">curve_info</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve_info</span> <span class="o">=</span> <span class="n">curve_info</span>
    
<div class="viewcode-block" id="Geom_step_to_gmsh.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Geom_step_to_gmsh.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Initialize Gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Create Gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>

        <span class="c1"># Import the STEP file</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">importShapes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Synchronize the CAD model with Gmsh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># You can retrieve curve (edge) IDs and set the desired number of seeds (divisions)</span>
        <span class="c1"># curves = gmsh_model.getEntities(dim=1)</span>
        <span class="c1"># print(&quot;Curves:&quot;, curves)  # List the curves (edges) to identify the ones at the bottom</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve_info</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">curve_id</span><span class="p">,</span> <span class="n">seed</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">curve_id</span><span class="p">),</span> <span class="n">seed</span><span class="p">)</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Cylinder_hertzian">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Cylinder_hertzian">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Cylinder_hertzian</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    
<div class="viewcode-block" id="Cylinder_hertzian.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Cylinder_hertzian.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Initialize Gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Create Gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="c1"># Create a new model</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Sphere_hertzian&quot;</span><span class="p">)</span>

        <span class="c1"># Import the STEP file</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">importShapes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Synchronize the CAD model with Gmsh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Identify the bottom edges (curves) and increase the number of divisions</span>
        <span class="c1"># You can retrieve curve (edge) IDs and set the desired number of seeds (divisions)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># print(&quot;Curves:&quot;, curves)  # List the curves (edges) to identify the ones at the bottom</span>

        <span class="c1"># Set more divisions on the bottom curves</span>
        <span class="c1"># Replace curve IDs with the actual curve IDs from the geometry</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]:</span>  
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">18</span><span class="p">]:</span>  
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">curve_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">]:</span>  
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curve_id</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c1"># for curve_id in [5,12,16]:  </span>
        <span class="c1">#     gmsh.model.mesh.setTransfiniteCurve(curve_id, 30)</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Block_3D_hex">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Block_3D_hex">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Block_3D_hex</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">divisions</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coord_left_corner : list</span>
<span class="sd">            Coordinates of the lower-left corner of the block [x0, y0, z0].</span>
<span class="sd">        coord_right_corner : list</span>
<span class="sd">            Coordinates of the upper-right corner of the block [x1, y1, z1].</span>
<span class="sd">        divisions : list</span>
<span class="sd">            Number of divisions along each axis [nx, ny, nz].</span>
<span class="sd">        mesh_size : float</span>
<span class="sd">            Scaling factor for the mesh size.</span>
<span class="sd">        gmsh_options : dict</span>
<span class="sd">            Optional Gmsh options.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">origin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span> <span class="o">=</span> <span class="n">divisions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="Block_3D_hex.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Block_3D_hex.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a 3D block with structured hexahedral mesh.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            A boolean value to show the mesh using Gmsh or not.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            Gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Parameters</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span>

        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>  <span class="c1"># Length along x-axis</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>  <span class="c1"># Length along y-axis</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="c1"># Length along z-axis</span>

        <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span>  <span class="c1"># Number of divisions along each axis</span>

        <span class="c1"># Create Gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># Initialize Gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Create box</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Box&quot;</span><span class="p">)</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">addBox</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Get entities for volumes, surfaces, and curves</span>
        <span class="n">volumes</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">surfaces</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Set transfinite lines to enforce structured mesh with different divisions on each axis        </span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nz</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ny</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nz</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ny</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nz</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ny</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nz</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ny</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">9</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>

        <span class="c1"># Apply transfinite meshing to all surfaces</span>
        <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surface</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Apply transfinite meshing to the volume</span>
        <span class="k">for</span> <span class="n">volume</span> <span class="ow">in</span> <span class="n">volumes</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteVolume</span><span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Recombine surfaces to convert triangular elements to quadrilateral</span>
        <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setRecombine</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">surface</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Recombine the volume to create hexahedral elements</span>
        <span class="k">for</span> <span class="n">volume</span> <span class="ow">in</span> <span class="n">volumes</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setRecombine</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">volume</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Synchronize geometry</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># Generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>

                         
<div class="viewcode-block" id="Block_3D">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Block_3D">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Block_3D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord_left_corner</span><span class="p">,</span> <span class="n">coord_right_corner</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span> <span class="o">=</span> <span class="n">coord_left_corner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span> <span class="o">=</span> <span class="n">coord_right_corner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="Block_3D.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Block_3D.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a 3D block.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Parameters</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">x1</span><span class="o">&gt;</span><span class="n">x0</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">y1</span><span class="o">&gt;</span><span class="n">y0</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">z1</span><span class="o">&gt;</span><span class="n">z0</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">z1</span> <span class="o">-</span> <span class="n">z0</span> 
        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthFromCurvature&quot;, 1);</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Box&quot;</span><span class="p">)</span>

        <span class="n">factory</span><span class="o">.</span><span class="n">addBox</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Rectangle_4PointBending">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Rectangle_4PointBending">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Rectangle_4PointBending</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l_beam</span><span class="p">,</span> <span class="n">h_beam</span><span class="p">,</span> <span class="n">region_size_dict</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">refine_factor</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_beam</span> <span class="o">=</span> <span class="n">l_beam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_beam</span> <span class="o">=</span> <span class="n">h_beam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span> <span class="o">=</span> <span class="n">region_size_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refine_factor</span> <span class="o">=</span> <span class="n">refine_factor</span>

<div class="viewcode-block" id="Rectangle_4PointBending.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Rectangle_4PointBending.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a rectangle with partitioned mesh.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Mesh size.</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="c1">#* min(self.l_beam,self.h_beam)</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Beam with partitioned mesh&quot;</span><span class="p">)</span>

        <span class="c1">#  corner points</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># left bottom, origin</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># right bottom</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_beam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># right top</span>
        <span class="n">c4</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># left top </span>
 
        <span class="c1"># location points</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p1</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p2</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p3</span>
        <span class="n">p4</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p4</span>
        <span class="n">p5</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r3&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p5</span>
        <span class="n">p6</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r3&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r3&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p6</span>
        <span class="n">p7</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r4&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p7  </span>
        <span class="n">p8</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r4&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r4&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p8</span>

        <span class="c1"># generate lines (use counter-clockwise direction)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">p8</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p8</span><span class="p">,</span> <span class="n">p7</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p7</span><span class="p">,</span> <span class="n">p6</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p6</span><span class="p">,</span> <span class="n">p5</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p5</span><span class="p">,</span> <span class="n">c4</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c4</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>

        <span class="c1"># The third elementary entity is the surface. In order to define a simple</span>
        <span class="c1"># rectangular surface from the four curves defined above, a curve loop has first</span>
        <span class="c1"># to be defined.</span>
        <span class="n">curve_loop</span> <span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">curve_loop</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># We can then define the surface as a list of curve loops (only one here,</span>
        <span class="c1"># representing the external contour, since there are no holes--see `t4.py&#39; for</span>
        <span class="c1"># an example of a surface with a hole):</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Before they can be meshed (and, more generally, before they can be used by API</span>
        <span class="c1"># functions outside of the built-in CAD kernel functions), the CAD entities must</span>
        <span class="c1"># be synchronized with the Gmsh model</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refine_factor</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;CurvesList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Sampling&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="n">lc</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">refine_factor</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;FieldsList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>


<div class="viewcode-block" id="Rectangle_4PointBendingCentered">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Rectangle_4PointBendingCentered">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Rectangle_4PointBendingCentered</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord_left_corner</span><span class="p">,</span> <span class="n">coord_right_corner</span><span class="p">,</span> <span class="n">region_size_dict</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">refine_factor</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span> <span class="o">=</span> <span class="n">coord_left_corner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span> <span class="o">=</span> <span class="n">coord_right_corner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span> <span class="o">=</span> <span class="n">region_size_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refine_factor</span> <span class="o">=</span> <span class="n">refine_factor</span>

<div class="viewcode-block" id="Rectangle_4PointBendingCentered.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Rectangle_4PointBendingCentered.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a rectangle with partitioned mesh.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Mesh size.</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="c1">#* min(self.l_beam,self.h_beam)</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Beam with partitioned mesh&quot;</span><span class="p">)</span>
        
        <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left_corner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right_corner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>    

        <span class="c1">#  corner points</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># left bottom, origin</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># right bottom</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># right top</span>
        <span class="n">c4</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># left top </span>
 
        <span class="c1"># location points</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p1</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p2</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p3</span>
        <span class="n">p4</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p4</span>
        <span class="n">p5</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r3&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r3&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p5</span>
        <span class="n">p6</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r3&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r3&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p6</span>
        <span class="n">p7</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r4&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r4&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p7  </span>
        <span class="n">p8</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r4&quot;</span><span class="p">][</span><span class="s2">&quot;center&quot;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">region_size_dict</span><span class="p">[</span><span class="s2">&quot;r4&quot;</span><span class="p">][</span><span class="s2">&quot;deviation&quot;</span><span class="p">],</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span> <span class="c1"># p8</span>

        <span class="c1"># generate lines (use counter-clockwise direction)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">p8</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p8</span><span class="p">,</span> <span class="n">p7</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p7</span><span class="p">,</span> <span class="n">p6</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p6</span><span class="p">,</span> <span class="n">p5</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p5</span><span class="p">,</span> <span class="n">c4</span><span class="p">)</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">c4</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>

        <span class="c1"># The third elementary entity is the surface. In order to define a simple</span>
        <span class="c1"># rectangular surface from the four curves defined above, a curve loop has first</span>
        <span class="c1"># to be defined.</span>
        <span class="n">curve_loop</span> <span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">curve_loop</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># We can then define the surface as a list of curve loops (only one here,</span>
        <span class="c1"># representing the external contour, since there are no holes--see `t4.py&#39; for</span>
        <span class="c1"># an example of a surface with a hole):</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Before they can be meshed (and, more generally, before they can be used by API</span>
        <span class="c1"># functions outside of the built-in CAD kernel functions), the CAD entities must</span>
        <span class="c1"># be synchronized with the Gmsh model</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refine_factor</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;CurvesList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Sampling&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="n">lc</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">refine_factor</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;FieldsList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>

    
<div class="viewcode-block" id="QuarterDisc">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.QuarterDisc">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">QuarterDisc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refine_times</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="k">if</span> <span class="n">angle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refine_times</span> <span class="o">=</span> <span class="n">refine_times</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="QuarterDisc.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.QuarterDisc.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a quarter disc with partition or without it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="n">x_loc_p3</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">y_loc_p3</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Rectangle&quot;</span><span class="p">)</span>

        <span class="n">p0</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span> <span class="n">lcar</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span> <span class="n">lcar</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">lcar</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span><span class="p">:</span>
            <span class="n">p3</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span> <span class="n">lcar</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">x_loc_p3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span><span class="p">)</span>
            <span class="n">y_loc_p3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span><span class="p">)</span>

        <span class="n">c1</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span><span class="p">:</span> 
            <span class="n">c3</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCircleArc</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p0</span><span class="p">,</span><span class="n">p3</span><span class="p">)</span>
            <span class="n">c4</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCircleArc</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span><span class="n">p0</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
            
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span><span class="p">,</span><span class="n">c4</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c3</span> <span class="o">=</span> <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCircleArc</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p0</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refine_times</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_rad</span><span class="p">:</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;CurvesList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">c4</span><span class="p">])</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Sampling&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="n">lcar</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">refine_times</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">/</span><span class="mi">10000</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;FieldsList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

            <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span><span class="p">,</span> <span class="n">x_loc_p3</span><span class="p">,</span> <span class="n">y_loc_p3</span></div>
</div>


    
<div class="viewcode-block" id="Line_1D">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Line_1D">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Line_1D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord_left</span><span class="p">,</span> <span class="n">coord_right</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">gmsh_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_left</span> <span class="o">=</span> <span class="n">coord_left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_right</span> <span class="o">=</span> <span class="n">coord_right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">=</span> <span class="n">mesh_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span> <span class="o">=</span> <span class="n">gmsh_options</span>

<div class="viewcode-block" id="Line_1D.generateGmshModel">
<a class="viewcode-back" href="../../../api/utils.geometry.html#utils.geometry.gmsh_models.Line_1D.generateGmshModel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generateGmshModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visualize_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a 3D block.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        visualize_mesh : boolean</span>
<span class="sd">            a booelan value to show the mesh using Gmsh or not</span>
<span class="sd">        Returns </span>
<span class="sd">        -------</span>
<span class="sd">        gmsh_model: Object</span>
<span class="sd">            gmsh model </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Parameters</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_left</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">z0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_right</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">assert</span><span class="p">(</span><span class="n">x1</span><span class="o">&gt;</span><span class="n">x0</span><span class="p">)</span>
        
        <span class="n">l</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="c1"># Mesh size.</span>
        <span class="n">lcar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_size</span> <span class="o">*</span> <span class="n">l</span>

        <span class="c1"># create gmsh model instance</span>
        <span class="n">gmsh_model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span>

        <span class="c1"># initialize gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMin&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.CharacteristicLengthMax&quot;</span><span class="p">,</span> <span class="n">lcar</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">command</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmsh_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#gmsh.option.setNumber(&quot;Mesh.CharacteristicLengthFromCurvature&quot;, 1);</span>
        <span class="n">point_a</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">)</span>
        <span class="n">point_b</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">)</span>
        
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">point_a</span><span class="p">,</span> <span class="n">point_b</span><span class="p">)</span>

        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="c1"># generate mesh</span>
        <span class="n">gmsh_model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualize_mesh</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;-nopopup&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
                <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gmsh_model</span></div>
</div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">CompSim-PINN</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=imcs-compsim&repo=pinns_for_comp_mech&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Institute for Mathematics and Computer-Based Simulation (IMCS).
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    
    <a href="https://github.com/imcs-compsim/pinns_for_comp_mech" class="github">
        <img src="../../../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>